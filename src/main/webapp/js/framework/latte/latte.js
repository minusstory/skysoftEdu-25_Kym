/*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.8.2] 2012/05/07 <ragnarok>
*
* 1. 문자열 자르기 : double, uni byte 를 설정가능하게 변경
*   - latte.str 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.8.1] 2012/01/10 <ragnarok>
*
* 1. 웹호환성 : 브라우저 문서모드 오류 패치
*   - latte.static 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.8] 2012/01/10 <ragnarok>
*
* 1. 웹호환성 : IE5(쿼크)~IE9 호환성 개선
*   - latte.static 수정
*   - latte.query 수정
*   - latte.dom.DragHandler 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.7] 2011/12/29 <ragnarok>
*
* 1. 기능개선 : IE 문서모드에 맞게 Javascript 가 동작하도록 개선
*   - latte.static 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.10] 2011/12/19 <ragnarok>
*
* 1. 기능개선 : 모바일과 IE7에서 부드러운 드래그가 되도록 수정 #2
*   - latte.dom.DragHandler 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.9] 2011/11/23 <ragnarok>
*
* 1. latte.str : uniByte 옵션 추가
*   - latte.static 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.8] 2011/10/24 <ragnarok>
*
* 1. 기능개선 : 모바일과 IE7에서 부드러운 드래그가 되도록 수정
*   - latte.dom.DragHandler 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.7] 2011/10/16 <ragnarok>
*
* 1. 기능개선 : byte 체크시 이벤트 종류를 지정할 수 있도록 개선
*   - latte.str 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.6] 2011/10/14 <ragnarok>
*
* 1. 버그패치 : IE7 이하에서 document 노드 비교 오류 해결
*   - latte.query 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.5] 2011/10/13 <ragnarok>
*
* 1. 버그패치 : 이중레이어에 의해 드래그가 안되는 문제점 해결
*   - latte.dom.DragHandler 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.4] 2011/10/01 <ragnarok>
*
* 1. 버그패치 : IE7 이하에서 id검색 오류를 해결함
*   - latte.query 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.3] 2011/09/27 <ragnarok>
*
* 1. 기능 개선 : (javascript가 비활성화일때 템플릿 노드가 나타나지 않도록 수정함)
*   - latte.static 수정
*
* 2. 기능 개선 : (이벤트 캡처노드를 100% x 100%로 변경함)
*   - latte.dom.DragHandler 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.2] 2011/09/08 <ragnarok>
*
* 1. 드래그 드랍 수정 : IE 버그 픽스
*   - latte.dom.DragHandler 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6.1] 2011/08/31 <ragnarok>
*
* 1. 공용으로 사용할 빈 함수 추가
*   - latte.blkFnc 작성
*
* 2. 등록된 이벤트 핸들러 전달인자 추가 (evt, win, tarNode)
*   - latte.observer 수정
*
* 3. 상대적위치 구하기 기능 개선
*   - latte.css.getRelativeOffset 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.6] 2011/08/24 <ragnarok>
*
* 1. latte.query 재작성
*   - latte.query 작성
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.9] 2011/08/23 <ragnarok>
*
* 1. 드래그 드랍 수정 : IE6, 7, Firefox 버그 픽스
*   - latte.dom.DragHandler 수정
*
* 2. 테이블 리사이즈 기승수정 : 리사이즈에 ctrl 버튼을 사용하지 않도록 변경
*   - latte.dom.TableResize 수정
*
* 3. XSS 방어 수정 : IE7 에서 node Hooking이 되지않아 임시로 우회처리함
*   - latte.security.XSS 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.8] 2011/08/12 <ragnarok>
*
* 1. latte.str.byte 추가 : 문자열을 byte 단위로 핸들링
*   - latte.static 수정
*
* 2. latte.tpl.node 추가 : 노드 템플릿 핸들링
*   - latte.static 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.7] 2011/06/03 <ragnarok>
*
* 1. 호출 주기를 동적으로 변경 가능하도록 수정
*   - latte.interval 수정
*
* 2. 패키지에만 발생하는 속성제거 오류 제거
*   - latte.range.Cleaner 수정
*
* 3. IE9 에서 TD 색상지정 오류 제거
*   - latte.selector.W3CDOMHandler 수정 : removeAllRanges() 를 try/catch 처리함
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.6] 2011/05/23 <ragnarok>
*
* 1. 개행시 스크롤 0:0 으로 이동되는 오류 수정
*   - latte.range.LineBreaker 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.5] 2011/05/20 <ragnarok>
*
* 1. deployNodes 기능 추가 : 지정된 노드들에 속한 특정 노드들의 속성을 일괄 적용함
*	- latte.command 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.4] 2011/05/11 <ragnarok>
*
* 1. style 노드의 type="text/css"로 지정하도록 변경
*	- latte.security.XSS 수정
*
* 2. latte.security.xss 객체 추가
*	- latte.security.XSS 수정 : 기본 객체 생성하도록 설정
*
* 3. latte.security.XSS.evade 함수 추가
*	- latte.security.XSS 수정 : 대상노드 이하 공격가능 노드를 선별하고 값을 변환함으로서 XSS 공격을 회피한다.
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.3] 2011/04/13 <ragnarok>
*
* 1. latte.cookie.getCookie IE 오류수정
*	- latte.cookie
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.2] 2011/03/31 <ragnarok>
*
*  1. 메타태그의 정보를 읽어오기위한 기능추가 : latte.getMetaValue()
*	- latte.static 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.1] 2011/03/30 <ragnarok>
*
* 1. observer 기능 추가
*	- latte.observer.add() : hID 를 반환하도록 기능 변경
*	- latte.observer.remove(hID) : Handle ID 에 해당하는 리소스를 파기한다.
*	- latte.observer.getResource(hID) : Handle ID 에 해당하는 리소스를 반환한다.
*
* 2. latte.css.removeClass 오류제거
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5.1] 2011/03/30 <ragnarok>
*
* 1. interval 기능 추가
*	- latte.interval.isStop(resource) : 중지상태인지를 boolean 으로 반환하는 기능 추가
*	- latte.interval() : resource 를 반환하도록 기능 변경
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5] 2011/03/17 <ragnarok>
*
* 1. latte.ajax POST 전송방식 추가
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5] 2011/02/24 <ragnarok>
*
* 1. latte.cookie 객체 추가
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5] 2011/02/22 <ragnarok>
*
* 1. 태그제거 오류 수정
*	- latte.security.XSS 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5] 2011/02/21 <ragnarok>
*
* 1. DragHandler Frame 에서도 동작하도록 수정 (FF3~4 포함)
*	- latte.dom.DragHandler 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.5] 2011/02/18 <ragnarok>
*
* 1. DragHandler 작성
*	- latte.dom.DragDrop class 제거
*	- latte.dom.dragdrop 인스턴스 제거
*	- latte.dom.DragHandler 작성
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b8] 2011/01/12 <ragnarok>
*
* 1. Selector 가 Document 를 선택한 경우 오류 처리
*	- latte.range.Marker 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b7] 2011/01/07 <ragnarok>
*
* 1. 템플릿 관리 기능 추가
*	- latte.dom.static 수정
*
* 2. 스크롤 정보 관리기능 추가
*	- latte.dom 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b6] 2010/12/22 <ragnarok>
*
* 1. dragdrop iframe 에서도 dragdrop 이 가능하도록 수정
*	- latte.dom.dragdrop 수정
*
* 2. getOuterHTML 기능 추가
*	- latte.dom 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b5] 2010/11/26 <ragnarok>
*
* 1. latte.array.merge 와 prototype F/W 충돌 해결
*	- latte.static 수정
*
* 2. IE 에서 개행후 스크롤 이동시 버튼 대신 anchor 를 이용하도록 변경
*	- latte.range.LineBreak 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b5] 2010/11/25 <ragnarok>
*
* 1. 임시오류수정 (latte.array 에서 prototype F/W 과 충돌)
*	- latte.static 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b4] 2010/11/18 <ragnarok>
*
* 1. 마크 원본위치 지정 오류 해결
*	- latte.range.Paragraph 수정
*
* 2. IE9 오동작 수정 (cloneRange 를 이용하여 끝/시작 마크 삽입)
*	- latte.range.Marker 수정
*
* 3. 텍스트 노드찾기 오류 수정
*	- latte.dom.getTextNodes 수정
*
* 4. OL, UL, DT, DD 태그 패턴 및 태그 목록 추가
*	- latte.selector.Selector 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b3] 2010/11/17 <ragnarok>
*
* 1. 선택영역 잡기 오류 수정
*	- latte.selector.TridentHandler 수정
*
* 2. 문단노드 구하기 오류수정
*	- latte.range.Paragraph 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b2] 2010/11/16 <ragnarok>
*
* 1. 포지션을 잡을때 텍스트노드 분할이 일어나지 않도록 변경
*	- latte.selector.TridentHandler 수정
*
* 2. undo, redo 가 동작하지 않아 수정함
*	- latte.selector.HistoryManage, latte.selector.History 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4b1] 2010/11/13 <ragnarok>
*
* 1. latte.selector.TridentHandler 재작성
*	- 근본적인 오류로 인하여 재작성함. 관련 객체 및 클래스 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4a5] 2010/11/09 <ragnarok>
*
* 1. 선택영역에 겹쳐지는 노드 가져오기 기능 추가
*	- latte.selector.Selector.isNodeOverlap() 추가
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4a4] 2010/11/05 <ragnarok>
*
* 1. 테이블 내부에서 에디터 기능이 동작 하도록 수정
*	- latte.selector.TridentHandler 수정
*
* 2. Trident engine의 경우 Spliter가 동작하는 중에 HTML 을 보정하기 때문에 이를 우회함
*	- latte.range.Spliter 수정
*
* 3. 테이블 초기 사이즈 보정
*	- latte.dom.TableResize 수정
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4a3] 2010/11/04 <ragnarok>
*
* 1. 테이블 이하 노드에서는 클린징되지 않도록 변경
*	- latte.range.Cleaner.js 변경
*
* 2. Firefox 에서 멀티셀렉터를 싱글로만 사용할 수 있도록 변경
*	- latte.selector.W3CDOMHandler 변경
*
* 3. IE8 까지는 테이블 전체가 선택되지 않으면 선택영역이 삭제되지 않아 수정
*	- latte.range.Spliter.js 변경
*
* ----------------------------------------------------------------------------------------------------------------------
* [v0.4a2] 2010/11/03 <ragnarok>
*
* 1. JQuery, Prototype F/W 와의 충돌 해결
*	- latte.iter, latte.isXXX, latte.HotKey 변경됨
*
* 2. single node가 선택된 경우 offset = undefined 인 오류를 보정함
*	- TridentHandler 변경됨
*
*/


(function(){var a=navigator.userAgent,c=document.documentMode||0,b=/msie/i.test(a);window.latte={ver:"0.8.2",debug:!1,FNC:function(){},OBJ:{},ARR:[],STR:"",INT:0,BOO:!0,isMSIE:b,isMSIE5:/msie 5/i.test(a),isMSIE55:/msie 5.5/i.test(a),isMSIE6:b&&c<=6,isMSIE7:b&&c==7,isMSIE8:b&&c==8,isMSIE9:b&&c==9,isFIREFOX:/firefox/i.test(a),isFIREFOX1:/firefox\/1/i.test(a),isFIREFOX2:/firefox\/2/i.test(a),isFIREFOX3:/firefox\/3/i.test(a),isFIREFOX4:/firefox\/4/i.test(a),verFIREFOX:a.match(/firefox\/([0-9\.]+)/i),isSAFARI:/safari/i.test(a)&&!/chrome/i.test(a),isNETSCAPE:/netscape/i.test(a),isCHROME:/chrome/i.test(a),isOPERA:/opera/i.test(a),isGECKO:/gecko/i.test(a),isKHTML:/khtml/i.test(a),isWEBKIT:/webkit/i.test(a),isPRESTO:/presto/i.test(a),isMOBILE:/mobile/i.test(a),isFNC:function(a){return typeof a===typeof latte.FNC},isOBJ:function(a){return typeof a===typeof latte.OBJ},isARR:function(a){return latte.isUND(a)?!1:a.constructor===latte.ARR.constructor},isSTR:function(a){return typeof a===typeof latte.STR},isINT:function(a){return typeof a===typeof latte.INT},isBOO:function(a){return typeof a===typeof latte.BOO},isUND:function(a){return typeof a=="undefined"}}})();if(latte.isFIREFOX)latte.browserVer=latte.verFIREFOX[1];latte.error={CLASS_AREADY_DEFINED:function(a){throw this.getError('"['+a+'] is aready defined." :: ');},CLASS_MUST_IMPLEMENT:function(a,c){throw this.getError('"The type ['+a+"] must implement the inherited abstract method ["+c+']" :: ');},getError:function(a){var a=Error(a),c=a.stack.split("@");c[0]="";c[1]="";a.message+=c[c.length-1];return a}};latte.iter=function(a,c){if(latte.isARR(a))for(var b=0;b<a.length;b++){if(c(a[b],b,a)===null)break}else for(b in a)if(c(a[b],b,a)===null)break};latte.array={merge:function(){for(var a=arguments,c=[],b=0,d;d=a[b];b++)c=c.concat(d);return c},unique:function(a){for(var c=[],b=a.length;--b>-1;){for(var d=b;--d>-1;)a[b]===a[d]&&(d=--b);latte.isUND(a[b])||c.push(a[b])}return c.reverse()},isContain:function(a,c){for(var b=a.length;b--;)if(a[b]===c)return!0;return!1}};latte.object={clone:function(a){var c={},b;for(b in a)c[b]=a[b];return c},merge:function(a,c){var b={},d;for(d in a)b[d]=a[d];for(d in c)b[d]=c[d];return b}};latte.blkFnc=new Function;latte.observer={hdlIdx:-1,hdlLst:[],add:function(a,c,b,d){var e=this,h=latte.getEvent,f=latte.dom.ele.getWindow(a),g=++e.hdlIdx;e.hdlLst[g]={idx:g,ele:a,event:c,fnc:b,useCapture:d,fncHdl:function(b){e.hdlLst[g]!==null&&e.hdlLst[g].fnc(h(b,f),f,a,g)}};d==null&&(d=!1);c=latte.isARR(c)?c:[c];latte.iter(c,function(b){latte.isMSIE?a.attachEvent("on"+b,e.hdlLst[g].fncHdl):a.addEventListener(b,e.hdlLst[g].fncHdl,d)});return g},remove:function(a){this.hdlLst[a]={fncHdl:function(){}}},getResource:function(a){return this.hdlLst[a]||null}};latte.getEvent=function(a,c){var c=c||window,b=a||c.event;if(!b.target&&b.srcElement)b.target=b.srcElement;if(!b.stopPropagation)b.stopPropagation=function(){this.cancelBubble=!0};if(!b.preventDefault)b.preventDefault=function(){this.returnValue=!0};b._window=c;b.stop=function(){this.stopPropagation();this.preventDefault();this.stopped=!0;this.returnValue=!1};b.posX=b.pageX||b.clientX+(c.document.documentElement.scrollLeft||c.document.body.scrollLeft);b.posY=b.pageY||b.clientY+(c.document.documentElement.scrollTop||c.document.body.scrollTop);if(typeof b.offsetX=="undefined")try{var d=latte.css.getRelativeOffset(c.document.body,b.target);b.offsetX=b.posX-b.target.offsetLeft-d.left;b.offsetY=b.posY-b.target.offsetTop-d.top}catch(e){b.offsetX=-1,b.offsetY=-1}return b};latte.getSelector=function(a){if(!a)return null;return(a=new latte.selector.Handler(a,latte.selector.MockSelector))?a.getSelector():null};latte.getTextSelector=function(a){return(a=new latte.selector.TextHandler(a,latte.selector.MockTextSelector))?a.getSelector():null};latte.xpath={getPath:function(a,c){c=c||"";if(a.parentNode==a.ownerDocument)return"/"+c;for(var b=0,d=a;d=d.previousSibling;)d.nodeName==a.nodeName&&b++;c="/"+a.nodeName+"["+b+"]"+c;return this.getPath(a.parentNode,c)},getNode:function(a,c){for(var b=c?c.documentElement:document.documentElement,d,e=a.match(/\/([^\/]+)/gi),h=0;h<e.length;h++){d=e[h];var f=-1;d=d.match(/([^\/\[\]])+/gi);for(var g=0;g<b.childNodes.length;g++)if(d[0]==b.childNodes[g].nodeName&&f++,d[1]==f&&(b=b.childNodes[g]))break}return b}};latte.tpl={eval:function(a,c){return a.replace(/#\{([a-z]+[0-9_]*)\}/gi,function(a,d){return latte.isUND(c[d])?"":c[d]})},node:{load:function(a,c){try{return(latte.isSTR(a)?latte.query("script[id="+a+"]",(c||document).body)[0]:a).innerHTML.replace(/(^[\s]*<\!--[\s]*|[\s]*--\>[\s]*$)/g,"")}catch(b){}return""},eval:function(a,c,b){var d=latte.dom.ele.create("div",b);d.innerHTML=latte.tpl.eval(this.load(a,b),c);for(a=d.firstChild;a&&a.nodeType!=1;)a=a.nextSibling;return a}}};latte.getMetaValue=function(a,c){var c=c||"content",b=latte.query("meta[name="+a+"]");if(b.length==1)return b[0].getAttribute(c);if(b.length>1)return function(){latte.iter(b,function(a,e){b[e]=a.getAttribute(c)});return b}()};latte.str={uniByte:2,dblByte:2,"byte":{length:function(a,c){var b=Array(latte.str.uniByte+1).join("."),d=Array(latte.str.dblByte+1).join("."),e=null,h=null;if(c)for(var f=0;f<c.length;f+=2)e=RegExp("("+c[f]+")","g"),h=Array(c[f+1]+1).join("."),a=a.replace(e,h);a=unescape(escape(a).replace(/%u[^%]{4}/g,b).replace(/%[8-9A-F][0-9A-F]/g,d));return a.length},substr:function(a,c,b,d){var e,c=[],h=[],f=0,g="",k=a.length,l=latte.str.uniByte,m=latte.str.dblByte;if(d)for(var i=0;i<d.length;i+=2)d[i+1]?(c.push(RegExp("("+d[i]+")","g")),h.push(d[i+1])):a=a.replace(RegExp("("+d[i]+")","g"),"");for(i=0;i<k;i++){d=a.charAt(i);e=!1;if(c.length){for(var j=0;j<c.length;j++)if(c[j].test(d)){f+=h[j];if(f>b)return[f-h[j],g];g+=d;if(f==b)return[f,g];e=!0;break}if(e)continue}e=escape(d);if(e=e.match(/%u[^%]{4}/)?l:e.match(/%[8-9A-F][0-9A-F]/)?m:0){if(f+=e,f>b)return[f-e,g]}else if(f+=1,f>b)return[f-1,g];g+=d;if(f==b)break}return[f,g]},startTailLsnr:function(a,c,b){a.byteInfo=c;var b=b||[],d=latte.isMSIE?"keyup":"input",e=!1;latte.iter(b,function(a){if(a==d)return e=!0,null});e||b.push(d);latte.observer.add(a,b,this.hdlTail)},hdlTail:function(a){var c=latte.str["byte"],a=a.target,b=a.byteInfo,d=c.length(a.value,b.extByte);if(b.lenNode){try{b.lenNode.innerHTML=d}catch(e){}b.lenNode.value=d}if(d>b.cutByte&&(b.msgTpl&&(d=latte.tpl.eval(b.msgTpl,{curByte:d,cutByte:b.cutByte}),alert(d)),c=c.substr(a.value,0,b.cutByte,b.extByte),a.value=c[1],b.lenNode)){try{b.lenNode.innerHTML=c[0]}catch(h){}b.lenNode.value=c[0]}}}};
if(typeof window.latte=="undefined")window.latte={};latte.cookie={setCookie:function(c,d,a,e,f){var b="";latte.isINT(a)&&a>=0&&(b=new Date,a==0?b.setTime(b.getTime()-86400):b.setTime(b.getTime()+a*1E3),b=b.toGMTString());document.cookie=""+c+"="+escape(d)+(b?"; expires="+b:"")+(e?"; path="+e:"")+(f?"; domain="+f:"")},getCookie:function(c){var d=null;latte.iter(document.cookie.split("; "),function(a){a=a.split("=");if(c==a[0])return d=unescape(a[1]||""),null});return d},expire:function(c){this.setCookie(c,"",0)}};
if(typeof window.latte=="undefined")window.latte={};latte.Logger={disabled:!0,level:3,logPane:null,logDoc:null,getDate:function(){var a=new Date;return a.getYear()+"/"+a.getMonth()+"/"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+" "+a.getSeconds()+","+a.getMilliseconds()},getNewLogNode:function(){if(this.disabled)return null;if(!this.logPane)this.logPane=window.open("","latteLoggerPanel","width=400,height=200,scrollbars=auto"),this.logDoc=this.logPane.document;var a=latte.dom.ele.create("p",this.logDoc);this.logDoc.body.appendChild(a);return a},error:function(a,b){this.disabled||this.level<1||this.logging("[ERROR:"+this.getDate()+"] "+a+"\nException : "+b.message)},debug:function(a){this.disabled||this.level<2||this.logging("[DEBUG:"+this.getDate()+"] "+a)},info:function(a){this.disabled||this.level<3||this.logging("[INFO:"+this.getDate()+"] "+a)},logging:function(a){this.getNewLogNode().innerHTML=a.replace(/\n/g,"<br/>")}};
if(typeof window.latte=="undefined")window.latte={};latte.Class=function(a){var a=latte.Class.getClass(a),b=latte.Class.getNewClass(a);latte.Class.extend(b,a);latte.Class.implement(a);latte.Class.defineProperty(b,a);latte.Class.addProperty(b,a);latte.Class.addMethod(b,a);latte.Class.addInstance(a);return latte.Class.defineClass(b,a)};latte.iter({instanceMap:{},preparePropertyName:{$name:"$name",$parent:"$extends",$interface:"$implements",$const:"$const"},addPropertyName:{_class:"_class",_className:"_className",instanceOf:"instanceOf",createUUID:"createUUID",_error:"_error",_debug:"_debug",_info:"_info"},getClass:function(a){return{$name:a[this.preparePropertyName.$name],$parent:latte.isFNC(a[this.preparePropertyName.$parent])?a[this.preparePropertyName.$parent]:null,$interface:latte.isARR(a[this.preparePropertyName.$interface])?a[this.preparePropertyName.$interface]:null,$const:latte.isFNC(a[this.preparePropertyName.$const])?a[this.preparePropertyName.$const]:null,$property:a}},getNewClass:function(a){try{latte.isUND(eval(a.$name))||latte.error.CLASS_AREADY_DEFINED(a.$name)}catch(b){}if(a.$const!=null)return a.$const;else if(a.$parent!=null){var c=(a.$parent+"").split("{"),a=c[0];c[0]="";c=c.join("{").substr(1);return new Function(a.match(/\(([^\)]*)\)/)[1],c.split(/\}$/,1))}return new Function},extend:function(a,b){if(b.$parent!=null)latte.iter(b.$parent.prototype,function(b,d){latte.Class.addPropertyName[d]||(a.prototype[d]=b,a.prototype["super$"+d]=b)}),a.prototype.super$=b.$parent},implement:function(){},defineProperty:function(a,b){latte.iter(b.$property,function(c,d){/^\$/.test(d)?b[d]||(a[d.substr(1)]=c):a.prototype[d]=c})},addProperty:function(a,b){a.prototype._className=a._className=b.$name;a.prototype._class=a._class=a},addMethod:function(a){a.prototype.instanceOf=a.instanceOf=function(a){return latte.Class.instanceOf(this._class,a)};a.prototype.createUUID=a.createUUID=function(a){return this._className+"."+(new Date).getTime()+(a||"")};a.prototype._error=a._error=function(b,c){latte.Logger.error(a._className+" : "+b,c)};a.prototype._debug=a._debug=function(b){latte.Logger.debug(a._className+" : "+b)};a.prototype._info=a._info=function(b){latte.Logger.info(a._className+" : "+b)}},addInstance:function(a){this.instanceMap[a.$name]={};a.$parent!=null&&latte.iter(latte.Class.instanceMap[a.$parent._className],function(b,c){latte.Class.instanceMap[a.$name][c]=b});a.$interface!=null&&latte.iter(a.$interface,function(b){latte.iter(latte.Class.instanceMap[b._className],function(b,d){latte.Class.instanceMap[a.$name][d]=b})});this.instanceMap[a.$name][a.$name]=!0},instanceOf:function(a,b){return latte.Class.instanceMap[a._className][b._className]===!0},defineClass:function(a,b){var c=b.$name.split(/\./g),d="window",e;for(e=0;e<c.length-1;e++)d+="."+c[e],latte.isUND(eval(d))&&eval(d+"={}");return eval(d)[c[e]]=a}},function(a,b){latte.Class[b]=a});latte.Class.singletone=function(a){a.getInstance=function(){this._class.instance=new this._class;this._class.prototype=new Function;this._class.getInstance=function(){return this.instance};return this.instance}};
if(typeof window.latte=="undefined")window.latte={};latte.Interface=function(a){var a=latte.Class.getClass(a),b=latte.Interface.getNewClass(a);latte.Interface.extend(b,a);latte.Interface.defineProperty(b,a);latte.Class.addProperty(b,a);latte.Class.addMethod(b,a);latte.Class.addInstance(a);return latte.Class.defineClass(b,a)};latte.iter({getInterfacePattern:function(a){a=(a+"").split("{",2)[0];return{pattern:a.replace(/\(([^\)]+[,]?)*\)/,function(a,d){return"("+(!latte.isUND(d)?d.replace(/[^,]+/g,"arg"):"")+")"}),define:a.replace(/^[^\(]+/,"")}},getNewClass:function(a){try{latte.isUND(eval(a.$name))||latte.error.CLASS_AREADY_DEFINED(a.$name)}catch(b){}return new Function},extend:function(a,b){b.$parent!=null&&latte.iter(b.$parent.prototype,function(b,c){a.prototype[c]=b})},defineProperty:function(a,b){latte.iter(b.$property,function(d,c){if(!b[c]){if(/^\$/.test(c))return a[c.substr(1)]=d;if(latte.isFNC(d)){var e=latte.Interface.getInterfacePattern(d);e.define=b.$name+"."+c+e.define;return a.prototype[c]=e}}})}},function(a,b){latte.Interface[b]=a});
if(typeof window.latte=="undefined")window.latte={};latte.json={parse:function(a){eval("var obj="+(a||"{}"));return obj},toJson:function(){return null}};
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.interval=="undefined")window.latte.interval={};latte.interval=function(a,b){var c=++latte.interval.ridx;latte.interval.rdata[c]={interval:a,isStop:!1,cnt:0,fnc:b,clear:function(){this.isStop=!0;this.fnc=function(){return!0}}};setTimeout(latte.interval.getCmdStr(c),a);return latte.interval.rdata[c]};latte.interval.ridx=-1;latte.interval.rdata=[];latte.interval.getCmdStr=function(a){var b="";b+="if (latte.interval.rdata["+a+"].fnc("+a+", latte.interval.rdata["+a+"].cnt++)) { latte.interval.rdata["+a+"].clear(); latte.interval.rdata["+a+"] = null; }\n";b+="else setTimeout(latte.interval.getCmdStr("+a+"), "+latte.interval.rdata[a].interval+");";return b};latte.interval.isStop=function(a){return a===null||latte.isUND(a)||a.isStop};
if(typeof window.latte=="undefined")window.latte={};latte.ajax=function(a){a=new latte.Ajax(a);a.request();return a};latte.Class({$name:"latte.Ajax",$const:function(a){this.config=latte.object.merge(this.config,a);this.xhr=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest},config:{url:location.href,method:"GET",contentType:"application/x-www-form-urlencoded",async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*",data:null},complete:function(){},error:function(){}},xhr:null,request:function(){if(this.config.data){var a="";latte.iter(this.config.data,function(b,c){a+="&"+c+"="+b});this.config.data=a.substring(1);if(this.config.method=="GET")this.config.url+=(this.config.url.match(/\?/)?"&":"?")+this.config.data,this.config.data=null}var b=this;this.xhr.open(this.config.method,this.config.url,this.config.async);this.xhr.setRequestHeader("Content-Type",this.config.contentType);this.xhr.setRequestHeader("Content-length",this.config.data==null?0:this.config.data.length);if(this.config.async)this.xhr.onreadystatechange=function(){b.xhr.readyState==4&&(b.xhr.status==200||b.xhr.status==0||latte.isFNC(b.config.complete)?b.config.complete(b):latte.isFNC(b.config.error)&&b.config.error(b))};this.xhr.send(this.config.data);if(!this.config.async)this.onreadystatechange(this)},onreadystatechange:function(a){a.xhr.readyState==4&&(a.xhr.status==200||a.xhr.status==0||latte.isFNC(a.config.complete)?a.config.complete(a):latte.isFNC(a.config.error)&&a.config.error(a))}});
if(typeof window.latte=="undefined")window.latte={};latte.Class({$name:"latte.HotKey",$KEYCODE:{f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,back:8,tab:9,enter:13,esc:27,pup:33,pdown:34,end:35,home:36,aleft:37,aup:38,aright:39,adown:40,ins:45,del:46,"[":219,"]":221},$METAKEY:{alt:"altKey",ctrl:"ctrlKey",shift:"shiftKey"},regist:function(a,b,c,d,e){var g=this,f=[];latte.isSTR(b)?f.push(b):f=b;latte.iter(f,function(b){g.registHotkey(a,b,c,d,e)})},genKeyData:function(a){for(var a=a.split(/[\r\n\t ]*\+[\r\n\t ]*/),b={altKey:!1,ctrlKey:!1,shiftKey:!1,keyCode:!1},c=0;c<a.length;c++){var d=a[c];latte.HotKey.METAKEY[d]?b[latte.HotKey.METAKEY[d]]=!0:b.keyCode=latte.HotKey.KEYCODE[d]?latte.HotKey.KEYCODE[d]:d.length==1?d.toUpperCase().charCodeAt(0):d}return b},registHotkey:function(a,b,c,d,e){b=this.getHotkeyName(this.genKeyData(b));if(latte.isUND(a._hotkey))a._hotkey={},latte.observer.add(a,"keydown",this.exec);a._hotkey[b]={hdlObj:c,fncName:d,args:e||{}};a._window=latte.dom.ele.getWindow(a)},exec:function(a){var b=latte.HotKey.getInstance(),a=latte.getEvent(a,b._window);a.target._hotkey&&b.fire(a.target,null,a);a.target.ownerDocument._hotkey&&b.fire(a.target.ownerDocument,null,a)},fire:function(a,b,c){if(!latte.isUND(a._hotkey)&&(b=this.getHotkeyName(c||this.genKeyData(b)),a=a._hotkey[b],!latte.isUND(a))){a.args.event=c;if(latte.isOBJ(a.hdlObj))a.hdlObj[a.fncName](a.args,c);else latte.isFNC(a.hdlObj)&&a.hdlObj(a.args,c);c&&a.args.isStop&&c.stop()}},getHotkeyName:function(a){return a.altKey+"+"+a.ctrlKey+"+"+a.shiftKey+"+"+a.keyCode}});latte.Class.singletone(latte.HotKey);
if(typeof window.latte=="undefined")window.latte={};latte.dom={};latte.dom.appendNode={before:function(a,b,c){b=latte.isSTR(b)?document.createElement(b):b;c!=null&&c(b);a.parentNode.insertBefore(b,a);return b},after:function(a,b,c){b=latte.isSTR(b)?document.createElement(b):b;c!=null&&c(b);a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b);return b}};latte.dom.move={contents:function(a,b){for(var c;b.firstChild;)c=b.firstChild,b.removeChild(c),a.appendChild(c);b.parentNode&&b.parentNode.removeChild(b)},strip:function(a){for(;a.firstChild;)refNode=a.firstChild,latte.dom.appendNode.before(a,refNode);a.parentNode&&a.parentNode.removeChild(a)}};latte.dom.popNode={before:function(a){for(;a.firstChild;){var b=a.firstChild;a.removeChild(b);latte.dom.appendNode.before(a,b)}a.parentNode.removeChild(a)},after:function(a){for(;a.lastChild;){var b=a.lastChild;a.removeChild(b);latte.dom.appendNode.after(a,b)}a.parentNode.removeChild(a)}};latte.dom.getInnerSize=function(a){a=a||window;if(a.innerHeight)return{width:a.innerWidth,height:a.innerHeight};else{a=latte.dom.ele.create("div",a.document);a.style.cssText="position:absolute;top:100%;left:100%;z-index:1;visibility:hidden";document.body.firstChild?latte.dom.appendNode.before(document.body.firstChild,a):document.body.appendChild(a);a.style.top=a.offsetTop+"px";a.style.left=a.offsetLeft+"px";var b={width:a.offsetLeft,height:a.offsetTop};document.body.removeChild(a);return b}};latte.dom.getCloseTag=function(a){return"</"+a.nodeName.toLowerCase()+">"};latte.dom.hookHTML=function(a,b,c){var d=latte.dom.ele.create("div",b);a.outerHTML?b=a.outerHTML:(d.appendChild(a.cloneNode(!0)),b=d.innerHTML);c&&(b=c(b));d.innerHTML=b;latte.dom.appendNode.before(a,d);latte.dom.move.strip(d);a.parentNode.removeChild(a)};latte.dom.getOpenTag=function(a){for(var b=[],c="",d=a.nodeName.toLowerCase(),c=0;c<a.attributes.length;c++)b.push(a.attributes[c].name+'="'+a.attributes[c].value+'"');(c=b.join(" "))&&(d=d+" "+c);return"<"+d+">"};latte.dom.scroll={getMax:function(a){return{width:latte.isUND(a.scrollMaxX)?a.document.documentElement.scrollWidth-a.document.documentElement.clientWidth:a.scrollMaxX,height:latte.isUND(a.scrollMaxY)?a.document.documentElement.scrollHeight-a.document.documentElement.clientHeight:a.scrollMaxY}},getPos:function(a){return{width:latte.isUND(a.pageXOffset)?a.document.documentElement.scrollLeft:a.pageXOffset,height:latte.isUND(a.pageYOffset)?a.document.documentElement.scrollTop:a.pageYOffset}}};latte.dom.getTextNodes=function(a,b){function c(a,b){if(a.node&&!(a.length!==null&&a.length<=0)&&!(a.node===a.nBreak||a.node.nodeName=="BODY"))if(d(a,b),a.node&&!(a.length!==null&&a.length<=0)&&!(a.node===a.nBreak||a.node.nodeName=="BODY"))a.node=latte.dom[b?"getParentNextNode":"getParentPrevNode"](a.node,a.nBreak),a.node&&c(a,b)}function d(a,b){if(a.node&&!(a.length!==null&&a.length<=0)&&!(a.node===a.nBreak||a.node.nodeName=="BODY"))if(e(a,b),!(a.length!==null&&a.length<=0)&&!(a.node===a.nBreak||a.node.nodeName=="BODY")){var c=a.node[b?"nextSibling":"previousSibling"];if(c)a.node=c,d(a,b)}}function e(a,b){if(a.node&&!(a.length!==null&&a.length<=0)&&!(a.node===a.nBreak||a.node.nodeName=="BODY"))if(a.node.nodeType==3){if(!a.node.previousSibling||!(a.node.previousSibling.nodeType!=3&&a.node.nextSibling&&a.node.nextSibling.nodeType!=3&&/^\s+$/.test(a.node.data)))a.cNodes.push(a.node),a.length!==null&&(a.length-=a.node.nodeValue.length)}else{var c=a.node[b?"firstChild":"lastChild"];if(c)a.node=c,e(a,b)}}b=latte.isUND(b)?!0:b;return c(a,b)};latte.dom.getParentNextNode=function(a,b){for(var c=a;c.parentNode&&c!==b&&c.nodeName!="BODY";)if(c=c.parentNode,c.nextSibling&&c.nextSibling!==b&&c.nextSibling.nodeName!="BODY")return c.nextSibling;return null};latte.dom.getParentPrevNode=function(a,b){for(var c=a;c.parentNode&&c!==b&&c.nodeName!="BODY";)if(c=c.parentNode,c.previousSibling&&c.previousSibling!==b&&c.previousSibling.nodeName!="BODY")return c.previousSibling;return null};latte.dom.ele={isSingleNode:function(a){if(a.nodeType==3)return!0;var b=this.create("div",a.ownerDocument);b.appendChild(this.create(a.nodeName,a.ownerDocument));return!RegExp("</"+a.nodeName+">$","i").test(b.innerHTML)},isEmptyNode:function(a){if(a.nodeType==3)return a.nodeValue.length==0;if(this.isSingleNode(a))return!1;if(a.childNodes.length==0)return!0;return a.childNodes.length==0},getOuterHTML:function(a){if(latte.isMSIE)return a.outerHTML;var b=this.create("div",a.ownerDocument);b.appendChild(a.cloneNode(!0));return b.innerHTML},clearEmptyNode:function(a,b){if(b){if(a){var c=a.childNodes;if(c.length)for(var d=c.length;d>=0;d--)this.clearEmptyNode(c[d],!0);return latte.dom.ele.clearEmptyNode(a)}}else{if(!this.isEmptyNode(a))return!1;a&&a.parentNode&&a.parentNode.removeChild(a);return!0}},clearSiblingNode:function(a,b){for(var c=a,d=b?"nextSibling":"previousSibling";c&&c[d];)latte.dom.ele.clearEmptyNode(c[d])||(c=c[d])},create:function(a,b){return(b==null?document:b).createElement(a)},createText:function(a,b){return(b==null?document:b).createTextNode(a)},emptyText:function(a){a=latte.dom.ele.create("b",a==null?document:a);a.innerHTML="&#x200B;";return a.firstChild},objectToElement:function(a,b,c){if(c==null)var d=/^on_/i,c=function(a,b,c){if(!d.test(c))return!1;latte.observer.add(a,c.substr(3),b[c]);richedit.addEvt.cnt[5]++;return!0};for(var e in b)c(a,b,e)||(a[e]=b[e])},getById:function(a,b){return(b||document).getElementById(a)||null},getByName:function(a,b){return(b||document).getElementsByName(a)||[]},getByTagName:function(a,b){return(b||document).getElementsByTagName(a)||[]},getByTagNames:function(a,b){var c={size:0},d;for(d in a){var e=this.getByTagName(a[d],b);e.length&&(c[a[d]]=e,c.size++)}return c},getByClassName:function(a,b){for(var c=[],d=this.getByTagName("*",b),e=RegExp("(^"+a+"$|^"+a+"[ \t]+|[ \t]+"+a+"$)"),f=0;f<d.length;f++)d[f].className.search(e)>-1&&c.push(d[f]);return c},getHead:function(a){return this.getByTagName("head",a)[0]},getInnerSize:function(a){var b=this.create("div",a.ownerDocument),c={};b.style.width="100%";b.style.height="100%";b.style.position="absolute";b.style.left="0px";b.style.top="0px";a.appendChild(b);c={width:b.offsetWidth,height:b.offsetHeight};a.removeChild(b);return c},getWindow:function(a){if(a.ownerDocument)return a.ownerDocument.parentWindow||a.ownerDocument.defaultView;if(a.document&&a.document.body)return a;return a.parentWindow||a.defaultView}};
if(typeof window.latte=="undefined")window.latte={};if(typeof latte.dom=="undefined")latte.dom={};latte.Class({$name:"latte.dom.DragHandler",cssText:"position:fixed;top:0px;left:0px;z-index:10000;width:100%;height:100%;border:0;background:#fff;cursor:pointer;-ms-filter:alpha(opacity=0);filter:alpha(opacity=0);opacity:0;-moz-opacity:0",useCover:!latte.isMSIE6&&!latte.isMOBILE,eDoc:window.document,init:function(){var b=latte.dom.DragHandler.getInstance(),e=b.eDoc;if(b.useCover&&!e._cover)e._cover=latte.dom.ele.create("div",e),e._cover.style.cssText=b.cssText},addTarget:function(b,e){var c=latte.dom.DragHandler.getInstance();if(!b._oDrag){var d=function(){b._oDrag={};var a=e||{};if(!latte.isFNC(a.down))a.down=new Function;if(!latte.isFNC(a.move))a.move=new Function;if(!latte.isFNC(a.up))a.up=new Function;b._oDrag={callbackHdl:a,curPos:{x:0,y:0},movPos:{x:0,y:0}};if(latte.isFIREFOX&&latte.browserVer>="4"||latte.isOPERA){if(a=latte.dom.ele.getWindow(b),latte.observer.add(b,"mousedown",function(a,d){c.mouseDown(a,d,b)}),!a._isBindDragEvent)latte.observer.add(a,"mouseup",c.mouseUp),latte.observer.add(a,"mousemove",c.mouseMove),a._isBindDragEvent=!0}else{var a=c.eDoc,d=(a=a._cover)||b;latte.observer.add(b,"mousedown",function(a,d){c.mouseDown(a,d,b)});if(!a||!a._isBindDragEvent)if(latte.observer.add(d,"mouseup",c.mouseUp),latte.observer.add(d,"mousemove",c.mouseMove),a)a._isBindDragEvent=!0}};document.readyState==="complete"?d():latte.observer.add(window,"load",d)}},setPosition:function(b,e){var c={x:b.screenX,y:b.screenY};e._oDrag.movPos={x:c.x-e._oDrag.curPos.x,y:c.y-e._oDrag.curPos.y};e._oDrag.curPos=c},mouseDown:function(b,e,c){var d=latte.dom.DragHandler.getInstance(),a=d.eDoc;a._cover&&a.body.appendChild(a._cover);d._eDrag=c;d.setPosition(b,c);c._oDrag.callbackHdl.down(b,e,c);b.stop()},mouseMove:function(b,e){var c=latte.dom.DragHandler.getInstance(),d=c._eDrag;d!=null&&(c.setPosition(b,d),d._oDrag.callbackHdl.move(b,e,d),b.stop())},mouseUp:function(b,e){var c=latte.dom.DragHandler.getInstance(),d=c._eDrag;if(d!=null){var a=c.eDoc;a._cover&&latte.interval(1,function(){a._cover&&a._cover.parentNode&&a._cover.parentNode.removeChild(a._cover);return!0});c._eDrag=null;d._oDrag.callbackHdl.up(b,e,d);b.stop()}}});latte.Class.singletone(latte.dom.DragHandler);latte.dom.DragHandler.getInstance().init();
if(typeof window.latte=="undefined")window.latte={};latte.Class({$name:"latte.dom.TableResize",aTarget:[],mouse:{dn:!1,re:!1,x:0,y:0},cell:{n:null,w:null,h:null},oInfo:null,addListner:function(b,a){function c(){var a=b.document,c=!1;latte.iter(e.aTarget,function(b){if(b==a)return c=!0,null});c||e.addObserver(a)}var e=latte.dom.TableResize.getInstance();a?c():latte.observer.add(b,"load",c)},addObserver:function(b){var a=latte.dom.TableResize.getInstance();a.aTarget.push(b);latte.observer.add(b,"mousedown",a.startResize);latte.observer.add(b,"mousemove",a.resize);latte.observer.add(b,"mouseup",a.stopResize)},startResize:function(b){var b=latte.getEvent(b),a=b.target,c=latte.dom.TableResize.getInstance();c.mouse.dn=!0;if(a.offsetParent&&a.offsetParent.nodeName=="TABLE"&&(c.getResizeInfo(b),c.oInfo)){c.mouse.re=!0;c.mouse.x=b.posX;c.mouse.y=b.posY;var a=c.oInfo.nCell,e,f=null,g=null,d=a.offsetParent;if(!d._isSetSize){d._isSetSize=!0;if(latte.isUND(d._bakCursorStyle))d._bakCursorStyle=d.style.cursor||"";c.iterationCell(d,function(a){f===null&&(e=b._window.getComputedStyle?b._window.getComputedStyle(a,null):a.currentStyle,f=e.borderLeftWidth.replace(/[^0-9]+/g,"")-0+(e.borderRightWidth.replace(/[^0-9]+/g,"")-0),g=e.borderTopWidth.replace(/[^0-9]+/g,"")-0+(e.borderBottomWidth.replace(/[^0-9]+/g,"")-0));a.setAttribute("width",a.offsetWidth-f);a.setAttribute("height",a.offsetHeight-g)})}d.style.width="auto";d.style.height="auto";d.setAttribute("width","auto");d.setAttribute("height","auto");c.cell.n=a;c.cell.w=a.width||a.offsetWidth;c.cell.h=a.height||a.offsetHeight}},stopResize:function(){var b=latte.dom.TableResize.getInstance();b.mouse.dn=!1;b.mouse.re=!1;b.oInfo=null;var a=b.cell.n;if(b.cell.n)a.offsetParent.style.cursor=a.offsetParent._bakCursorStyle,b.cell.n=null},resize:function(b){var a,c;try{b=latte.getEvent(b),a=b.target,oTBResizer=latte.dom.TableResize.getInstance(),c=a.ownerDocument.body}catch(e){return null}if(!oTBResizer.mouse.re){if(!a.offsetParent||a.offsetParent.nodeName!="TABLE"||oTBResizer.mouse.dn)return;var f=oTBResizer.getResizeInfo(b);if(f){if(latte.isMSIE)c.contentEditable="false";oTBResizer.changePointer(b,f)}else{if(latte.isMSIE)c.contentEditable=c._backEditable||"false";var g=a.offsetParent;if(!latte.isUND(g._bakCursorStyle))g.style.cursor=g._bakCursorStyle}}if(oTBResizer.cell.n&&oTBResizer.mouse.re&&oTBResizer.oInfo)try{if(a=oTBResizer.cell.n,oTBResizer.oInfo.nmAtt=="width")for(var g=a.offsetParent,d=a.parentNode,i=parseInt(oTBResizer.cell.w)+parseInt(b.posX-oTBResizer.mouse.x),h=0;h<g.rows.length;h++)g.rows[h].cells[a.cellIndex].width=i;else for(var d=a,j=parseInt(oTBResizer.cell.h)+parseInt(b.posY-oTBResizer.mouse.y),h=0;h<d.cells.length;h++)d.cells[h].height=j}catch(k){}},changePointer:function(b,a){var c=b.target.offsetParent;if(latte.isUND(c._bakCursorStyle))c._bakCursorStyle=c.style.cursor||"";c.style.cursor=a?a.nmAtt=="width"?"e-resize":"n-resize":""},iterationCell:function(b,a){if(b.rows)for(var c,e=0;e<b.rows.length;e++){c=b.rows[e];for(var f=0;f<c.cells.length;f++)a(c.cells[f])}},getResizeInfo:function(b){var a=latte.dom.TableResize.getInstance(),c=function(){var a=b.target;if(b.offsetX<4&&a.cellIndex)return{nCell:a.offsetParent.rows[a.parentNode.rowIndex].cells[a.cellIndex-1],nmAtt:"width"};if(b.offsetX>a.offsetWidth-4)return{nCell:a,nmAtt:"width"};if(b.offsetY<4&&a.parentNode.rowIndex)return{nCell:a.offsetParent.rows[a.parentNode.rowIndex-1],nmAtt:"height"};if(b.offsetY>a.offsetHeight-4)return{nCell:a.parentNode,nmAtt:"height"};return null}();return a.oInfo=c}});latte.Class.singletone(latte.dom.TableResize);
if(typeof window.latte=="undefined")window.latte={};latte.css={ptnRelativeSize:/^[0-9]+%$/,getValue:function(a,b){if(a.ownerDocument.defaultView)return a.ownerDocument.defaultView.getComputedStyle(a,null)[b];else if(a.currentStyle)return a.currentStyle.getAttribute(b)},styleLength:function(a){return latte.isMSIE?a.style.split(";").length:a.style.length},getRealSize:function(a){return{width:parseInt(a.offsetWidth),height:parseInt(a.offsetHeight)}},getRelativeOffset:function(a,b){var c=!1;if(latte.isUND(b)){for(c=a.offsetParent;c;){switch(latte.css.getValue(c,"position")){case "relative":case "absolute":break;default:if(c.nodeName=="body")break;c=c.offsetParent;continue}break}b=a;a=c;c=!0}var d={top:0,bottom:0,left:0,right:0,getTop:function(){return this.top-this.bottom},getLeft:function(){return this.left-this.right}};if(a==b)return d;for(var e=b.offsetParent;e;){if(e==a)return d;d.top+=e.offsetTop||0;d.bottom+=e.offsetBottom||0;d.left+=e.offsetLeft||0;d.right+=e.offsetright||0;e=e.offsetParent}c&&(d.top+=b.offsetTop,d.left+=b.offsetLeft);return d},setRealSize:function(a,b){var c;if(b.width!=null)if(c=!this.ptnRelativeSize.test(b.width)){if(a.clientWidth<=0)a.style.width="100px";c=b.width+a.clientWidth-a.offsetWidth;a.style.width=(c>0?c:0)+"px"}else a.style.width=b.width;if(b.height!=null)if(c=!this.ptnRelativeSize.test(b.height)){if(a.clientHeight<=0)a.style.height="100px";c=b.height+a.clientHeight-a.offsetHeight;a.style.height=(c>0?c:0)+"px"}else a.style.height=b.height},getNumber:function(a){return a.replace(/[^0-9-\+]+/g,"")-0},addClass:function(a,b){var c=a.className||"";c?RegExp("(^"+b+"$|^"+b+"[ \t]+|[ \t]+"+b+"[ \t]+|[ \t]+"+b+"$)").test(c)||(a.className+=" "+b):a.className=b},removeClass:function(a,b){a.className=a.className.replace(RegExp("(^"+b+"$|^"+b+"[ \t]+|[ \t]+"+b+"[ \t]+|[ \t]+"+b+"$)","g")," ").replace(/(^[ \t]+|[ \t]+$)/g,"")},isContain:function(a,b){return RegExp("(^|\\s)"+b+"(\\s|$)","g").test(a.className||"")}};
document.querySelector?latte.query=function(a,b){for(var e=[],g=(b||document).querySelectorAll(a)||[],c=0;c<g.length;c++)e.push(g[c]);return e}:(latte.query=function(a,b){for(var b=b||document,e=latte.query.selector,g=a.split(","),c=[],h=0,d;d=g[h];h++){var f=d.match(/(.*#[\w]+[^>|\+|\s]*)([>|\+|\s].*)/)||[];d=e.compile(d,f[1]||d,f[2]||"");var f=d.backward.length-1,j=d.backward[f].filter,i=[],m=[];if(j.id){var k=/document/i.test(b.nodeName)?b:b.ownerDocument;i.push(k.getElementById(j.id))}else i=b.getElementsByTagName(j.tag.toLowerCase());for(var k=0,l;l=i[k];k++)j.func(l,!0)&&e.findNode(b,l,d.backward,f-1,!0)&&m.push(l);c=c.concat(d.filter(m,d.forward,!0))}return latte.array.unique(c)},latte.query.selector={cache:{},regexp:{bparse:/([^>|\+|\s]+)\s*([>|\+]?)\s*/g,fparse:/\s*([>|\+]?)\s*([^>|\+|\s]+)/g,tag:/^([\w-]+)/,id:/#([\w-]+)/g,cls:/\.([\w-]+)/g,pseudo:/:([\w-]+(\(.*\))?)/g,pseudoparse:/([\w-]+)(\((.*)\))?/,attr:/\[([^\]]+)]/g,attrparse:/^(\[)([\w-]+)([!|\^|\$|\*]?=)*(.*)(\])$/},previousNode:function(a){for(;a&&(a=a.previousSibling)&&a.nodeType!=1;);return a},nextNode:function(a){for(;a&&(a=a.nextSibling)&&a.nodeType!=1;);return a},nodeIndex:function(a){for(var b=1,e=a.parentNode.firstChild;e&&e!=a;e=this.nextNode(e),b++);return b},pseudo:{first_child:function(a){return latte.query.selector.previousNode(a)?!1:!0},last_child:function(a){return latte.query.selector.nextNode(a)?!1:!0},empty:function(a){return a.firstChild?!1:!0},contains:function(a,b){return a.innerHTML.indexOf(b)>-1}},filter:function(a,b){var e={},g={},c=["true"],h="var querySelector = latte.query.selector;\n",d,f,j;if(f=a.match(this.regexp.id)){if(f[1])return!1;e.id=f[0].substr(1)}f=a.match(this.regexp.tag);e.tag=f&&f[1]||"*";if(d=a.match(this.regexp.cls))for(f=0;j=d[f];f++)c.push('latte.css.isContain(o,"'+j.substr(1)+'")');if(d=a.match(this.regexp.pseudo))for(f=0;j=d[f];f++)j=j.substr(1).match(this.regexp.pseudoparse),c.push("querySelector.pseudo."+j[1].replace("-","_")+'(o, "'+j[3]+'")');if(j=a.match(this.regexp.attr)){var i;for(f=0;i=j[f];f++)switch(i=i.match(this.regexp.attrparse),d="v_"+i[2],g[i[2]]||(h+="var "+d+' = o.getAttribute("'+i[2]+'");\n',g[i[2]]=!0),i[3]){case "=":c.push(d+' == "'+i[4]+'"');break;case "!=":c.push(d+' != "'+i[4]+'"');break;case "^=":c.push(d+'.indexOf("'+i[4]+'") == 0');break;case "$=":c.push(d+".substr("+d+'.length - "'+i[4]+'".length) == "'+i[4]+'"');break;case "*=":c.push(d+'.indexOf("'+i[4]+'") > -1');break;default:c.push(d+" != null")}}e.tag&&e.tag!="*"&&c.push('(casei ? o.tagName.toLowerCase() == "'+e.tag.toLowerCase()+'" : o.tagName == "'+e.tag+'")');b&&e.id&&c.push('o.id == "'+e.id+'"');e.func=new Function("o","casei",h+"\nreturn ("+c.join(" && ")+")");return e},findNode:function(a,b,e,g,c){if(g==-1)return!0;var h=e[g];switch(h.type){case "":for(b=b.parentNode;b!=a;b=b.parentNode)if(h.filter.func(b,c)&&this.findNode(a,b,e,g-1,c))return!0;break;case ">":if((b=b.parentNode)&&b!=a&&h.filter.func(b,c)&&this.findNode(a,b,e,g-1,c))return!0;break;case "+":if((b=this.previousNode(b))&&h.filter.func(b,c)&&this.findNode(a,b,e,g-1,c))return!0}return!1},compile:function(a,b,e){if(!this.cache[a]){var g={backward:[],forward:[]},c=this;b.replace(this.regexp.bparse,function(a,b,d){g.backward.push({type:d,filter:c.filter(b,!0)})});var h=0,d,f=["var querySelector = latte.query.selector;"];e.replace(this.regexp.fparse,function(a,b,e){g.forward.push({type:b,filter:c.filter(e)});switch(b){case ">":d="getChildren";break;case "":d="getOffspring";break;case "+":d="getBrother"}f.push("result = querySelector."+d+"(result, forward["+h++ +"].filter, casei);")});f.push("return result;");g.filter=new Function("result","forward","casei",f.join("\n"));this.cache[a]=g}return this.cache[a]},getChildren:function(a,b,e){for(var g=[],c,h=0;c=a[h];h++)for(c=c.firstChild;c;c=this.nextNode(c))b.func(c,e)&&g.push(c);return g},getOffspring:function(a,b,e){for(var g=[],c,h=0;c=a[h];h++){c=c.getElementsByTagName(b.tag);for(var d=0,f;f=c[d];d++)b.func(f,e)&&g.push(f)}return g},getBrother:function(a,b,e){for(var g=[],c,h=0,d;d=a[h];h++)(c=this.nextNode(d))&&b.func(c,e)&&g.push(c);return g}});
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Interface({$name:"latte.selector.Selector",$TAG_PARAGRAPH:"p,div,h1,h2,h3,h4,h5,h6,address,ul,ol,li,dd,dt,table,tbody,tr,td,th",$EXP_PARAGRAPH:/^(p|div|h1|h2|h3|h4|h5|h6|address|ul|ol|li|dd|dt|table|tbody|tr|td|th)$/i,$TAG_TABLE:"table,tbody,tr,td,th",$EXP_TABLE:/^(table|tbody|tr|td|th)$/i,$TAG_OLUL:"ol,ul,li,dt,dd",$EXP_OLUL:/^(ol|ul|li|dt|dd)$/i,$EXP_BODY:/^body$/i,$START_TO_START:0,$START_TO_END:1,$END_TO_END:2,$END_TO_START:3,collapse:function(){},cloneContents:function(){},deleteContents:function(){},extractContents:function(){},insertNode:function(){},surroundContents:function(){},setEnd:function(){},setEndBefore:function(){},setEndAfter:function(){},setStart:function(){},setStartBefore:function(){},setStartAfter:function(){},selectNode:function(){},selectNodeContents:function(){},compareBoundaryPoints:function(){},cloneRange:function(){},getString:function(){},detach:function(){},isNodeInSelector:function(){},isNodeOverlap:function(){},isSelectorOverlap:function(){},select:function(){}});
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Interface({$name:"latte.selector.TextSelector",getPosition:function(){},select:function(){},copy:function(){},cut:function(){},paste:function(){}});
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Class({$name:"latte.selector.MockSelector",$implements:[latte.selector.Selector],$const:function(a){this._hdl=a;this.start={node:null,offset:null};this.end={node:null,offset:null}},_hdl:null,collapsed:!1,blockNode:null,start:null,end:null,collapse:function(a){return this._hdl.collapse(a)},cloneContents:function(){return this._hdl.cloneContents()},deleteContents:function(){this._hdl.deleteContents()},extractContents:function(){return this._hdl.extractContents()},insertNode:function(a){this._hdl.insertNode(a)},surroundContents:function(a){this._hdl.surroundContents(a)},setEnd:function(a,b){this._hdl.setEnd(a,b)},setEndBefore:function(a){this._hdl.setEndBefore(a)},setEndAfter:function(a){this._hdl.setEndAfter(a)},setStart:function(a,b){this._hdl.setStart(a,b)},setStartBefore:function(a){this._hdl.setStartBefore(a)},setStartAfter:function(a){this._hdl.setStartAfter(a)},selectNode:function(a){this._hdl.selectNode(a)},selectNodeContents:function(a){this._hdl.selectNodeContents(a)},compareBoundaryPoints:function(a,b){return this._hdl.compareBoundaryPoints(a,b)},cloneRange:function(){return this._hdl.cloneRange()},getString:function(){return this._hdl.getString()},detach:function(){this._hdl.detach()},isNodeInSelector:function(a){return this._hdl.isNodeInSelector(a)},isNodeOverlap:function(a){return this._hdl.isNodeOverlap(a)},isSelectorOverlap:function(a){return this._hdl.isSelectorOverlap(a)},isMultiLine:function(){var a=!1;try{a=latte.query(latte.selector.Selector.TAG_PARAGRAPH,this.blockNode).length>0}catch(b){}return a},select:function(){return this._hdl.select()}});
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Class({$name:"latte.selector.MockTextSelector",$implements:[latte.selector.TextSelector],$const:function(a){this._hdl=a;this.offset={start:-1,end:-1}},_hdl:null,offset:null,getPosition:function(){return this._hdl.getPosition()},select:function(a,b){return this._hdl.select(a,b)},copy:function(){return this._hdl.copy()},cut:function(){return this._hdl.cut()},paste:function(a){this._hdl.paste(a)}});
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Class({$name:"latte.selector.TridentHandler",$implements:[latte.selector.Selector],$const:function(a,c){if(!a)return!1;this.win=a;this.doc=this.win.document;this.selector=new c(this)},$addListner:function(a){!a._latestRange&&a.selection&&(latte.observer.add(a,"selectionchange",function(){a._rangeChecked=!0}),richedit.addEvt.cnt[11]++)},win:null,doc:null,selector:null,range:null,compFlag:["StartToStart","StartToEnd","EndToEnd","StartToEnd"],getSelector:function(){function a(a,b,c,d){var e=a.range,f=a.range.duplicate(),g=c.start,h=d?"EndToStart":"EndToEnd",j,i,k=null;latte.iter(b,function(a,c){i=a.data.length;latte.dom.appendNode.before(a,g.node);f.moveToElementText(g.node);if(c-0==0&&f.compareEndPoints(h,e)===1)return null;f.moveEnd("character",i);j=f.compareEndPoints(h,e);if(c-0==b.length-1&&j===-1)return null;switch(j){case 1:for(;i>=0&&j>0;)--i,f.moveEnd("character",-1),j=f.compareEndPoints(h,e);case 0:return k={node:a,offset:i<0?0:i},null}});g.remove();return k}function c(a,b,c,d){var e=a.range,f=a.range.duplicate(),g=d?"StartToStart":"StartToEnd",h=d?"EndToStart":"EndToEnd",j,i,k=null;latte.iter(b,function(b){latte.dom.appendNode.before(b,c.start.node);latte.dom.appendNode.after(b,c.end.node);f.moveToElementText(c.start.node);j=f.compareEndPoints(g,e);c.start.remove();f.moveToElementText(c.end.node);i=f.compareEndPoints(h,e);c.end.remove();if(j==0)return k={node:b.parentNode,offset:a.findNodeOffset(b)},null;else if(i==0)return k={node:b.parentNode,offset:a.findNodeOffset(b)+1},null;else if(j==-1&&i==1)return k=e.htmlText.length?d?{node:b.parentNode,offset:a.findNodeOffset(b)}:{node:b.parentNode,offset:a.findNodeOffset(b)+1}:d?{node:b.parentNode,offset:a.findNodeOffset(b)+1}:{node:b.parentNode,offset:a.findNodeOffset(b)},null});return k}if(!this.win)return null;var b=this.selector,d=this.doc.body;b.end={node:d,offset:0};b.start={node:d,offset:0};b.blockNode=d;b.collapsed=!0;if(!this.doc._rangeChecked)return this.range=d.createTextRange(),this.range.collapse(!0),b;this.createUUID();var f=this.createMark();this.range=this.doc.selection.createRange();if(!this.range.parentElement&&this.range.length){var e=this.range.item(0),g=d.createTextRange();latte.dom.appendNode.before(e,f.start.node);latte.dom.appendNode.after(e,f.end.node);this.range=d.createTextRange();this.range.moveToElementText(e);g.moveToElementText(f.start.node);this.range.setEndPoint("StartToStart",g);g.moveToElementText(f.end.node);this.range.setEndPoint("EndToEnd",g);f.start.remove();f.end.remove()}if(this.range.parentElement().ownerDocument!==this.doc)return null;this.range.duplicate();d=this.range.htmlText.length;e=this.getBlockNode(this.range);g={nBreak:e,cNodes:[],node:e.firstChild||e,length:null};latte.dom.getTextNodes(g);var g=g.cNodes,h=latte.query("*",e);if(!g.length&&!h.length)b.start={node:e,offset:0},b.end={node:e,offset:0};else if(g.length){b.start=a(this,g,f,!0);if(!b.start)b.start=c(this,h,f,!0);if(!b.start)b.start={node:e,offset:0};b.end=a(this,g,f,!1);if(!b.end)b.end=c(this,h,f,!1);if(!b.end)b.end={node:e,offset:0}}else b.start=c(this,h,f,!0),b.end=c(this,h,f,!1);b.collapsed=d?!1:!0;b.blockNode=b.collapsed?b.start.node:e;return b},getBlockNode:function(a){var c=a.duplicate(),b=a.parentElement();try{do if(c.moveToElementText(b),c.inRange(a))break;while(b.nodeName!="BODY"&&b.parentNode&&(b=b.parentNode))}catch(d){}return b},createMark:function(){var a=this,c=this.createUUID().replace(/\./g,"_"),c={start:{node:latte.dom.ele.create("a",a.doc),uuid:c+"ss",getNode:function(){return a.doc.getElementById(this.uuid)},remove:function(){var b=a.doc.getElementById(this.uuid);b&&b.parentNode&&b.parentNode.removeChild(b)}},end:{node:latte.dom.ele.create("a",a.doc),uuid:c+"se",getNode:function(){return a.doc.getElementById(this.uuid)},remove:function(){var b=a.doc.getElementById(this.uuid);b&&b.parentNode&&b.parentNode.removeChild(b)}}};c.start.node.setAttribute("id",c.start.uuid);c.end.node.setAttribute("id",c.end.uuid);c.start.node.innerHTML="{[";c.end.node.innerHTML="]}";c.end.node.className="latte_mark_temp";c.end.node.className="latte_mark_temp";if(!latte.debug)c.end.node.style.textIndent="-500",c.end.node.style.textIndent="-500";return c},getSelectionInfo:function(a){var c=this.selector.start.node,b=this.selector.start.offset,d=this.selector.end.node,f=this.selector.end.offset,e=this.createMark(),g=this.range.duplicate();d.nodeType!=3&&(d.childNodes[f]?latte.dom.appendNode.before(d.childNodes[f],e.end.node):d.appendChild(e.end.node),g.moveToElementText(e.end.node),this.range.setEndPoint("EndToEnd",g),this.range.moveEnd("character",a?-2:-1));c.nodeType!=3&&(c.childNodes[b]?latte.dom.appendNode.before(c.childNodes[b],e.start.node):c.appendChild(e.start.node),g.moveToElementText(e.start.node),this.range.setEndPoint("StartToStart",g),this.range.moveStart("character",a?2:1));var h=this,a=latte.dom.ele.create("div",this.doc);a.innerHTML=this.range.htmlText;var l;(l=latte.query("[id="+e.start.uuid+"]",a)[0])&&l.parentNode.removeChild(l);(l=latte.query("[id="+e.end.uuid+"]",a)[0])&&l.parentNode.removeChild(l);return{nContent:a,text:this.range.text,restore:function(){e.start.remove();e.end.remove();var a=h.selector;h.setStart(a.start.node,a.start.offset);h.setEnd(a.end.node,a.end.offset)}}},findNodeOffset:function(a){for(var c=0;a=a.previousSibling;)c++;return c},setStartProperty:function(){var a=this.selector.start.node,c=this.selector.start.offset,b=this.range.duplicate(),d=latte.dom.ele.create("a",this.doc);try{a.nodeType==3?(latte.dom.appendNode.before(a,d),b.moveToElementText(d),b.moveEnd("character",c)):(a.childNodes[c]?latte.dom.appendNode.before(a.childNodes[c],d):a.appendChild(d),b.moveToElementText(d)),this.range.setEndPoint("StartToEnd",b)}catch(f){}d.parentNode&&d.parentNode.removeChild(d)},setEndProperty:function(){var a=this.selector.end.node,c=this.selector.end.offset,b=this.range.duplicate(),d=latte.dom.ele.create("a",this.doc);try{a.nodeType==3?(latte.dom.appendNode.before(a,d),b.moveToElementText(d),b.moveStart("character",c)):(a.childNodes[c]?latte.dom.appendNode.before(a.childNodes[c],d):a.appendChild(d),b.moveToElementText(d)),this.range.setEndPoint("EndToStart",b)}catch(f){}d.parentNode&&d.parentNode.removeChild(d)},setProperty:function(){this.setStartProperty();this.setEndProperty();this.selector.collapsed=this.range.htmlText.length?!1:!0;this.selector.blockNode=this.selector.collapsed?this.selector.start.node:this.range.parentElement()},collapse:function(a){a?this.setEnd(this.selector.start.node,this.selector.start.offset):this.setStart(this.selector.end.node,this.selector.end.offset)},cloneContents:function(){for(var a=this.doc.createDocumentFragment(),c=this.getSelectionInfo(!0);c.nContent.firstChild;)a.appendChild(c.nContent.firstChild);c.restore();return a},deleteContents:function(){var a=this.getSelectionInfo(!1);this.range.text="";a.restore();this.collapse(!0)},extractContents:function(){var a=this.cloneContents();this.deleteContents();return a},insertNode:function(a){var c=this.selector.start.node,b=this.selector.start.offset;if(c.nodeType==3)if(b)if(b==c.length)latte.dom.appendNode.after(c,a);else{var d=c.cloneNode(!1);latte.dom.appendNode.after(c,d);latte.dom.appendNode.before(d,a);c.data=c.data.substr(0,b);d.data=d.data.substr(b)}else latte.dom.appendNode.before(c,a);else c.childNodes[b]?latte.dom.appendNode.before(c.childNodes[b],a):c.appendChild(a)},surroundContents:function(a){var c=this.extractContents();a.appendChild(c);this.insertNode(a);this.selectNode(a)},setStart:function(a,c){this.selector.start={node:a,offset:c};this.setProperty()},setStartBefore:function(a){this.setStart(a.parentNode,this.findNodeOffset(a))},setStartAfter:function(a){this.setStart(a.parentNode,this.findNodeOffset(a)+1)},setEnd:function(a,c){this.selector.end={node:a,offset:c};this.setProperty()},setEndBefore:function(a){this.setEnd(a.parentNode,this.findNodeOffset(a))},setEndAfter:function(a){this.setEnd(a.parentNode,this.findNodeOffset(a)+1)},selectNode:function(a){this.selector.start={node:a.parentNode,offset:this.findNodeOffset(a)};this.selector.end={node:a.parentNode,offset:this.findNodeOffset(a)+1};this.setProperty()},selectNodeContents:function(a){this.selector.start={node:a,offset:0};this.selector.end={node:a,offset:a.nodeType==3?a.length:a.childNodes.length+1};this.setProperty()},compareBoundaryPoints:function(a,c){return this.range.compareEndPoints(this.compFlag[a],c)},cloneRange:function(){var a=this.selector,c=new this._class(this.win,a._class),b=c.selector;c.range=this.range.duplicate();b.collapsed=a.collapsed;b.blockNode=a.blockNode;b.start.node=a.start.node;b.start.offset=a.start.offset;b.end.node=a.end.node;b.end.offset=a.end.offset;return b},getString:function(){var a=this.getSelectionInfo(!0),c=a.text;a.restore();return c},detach:function(){},isNodeInSelector:function(a){var c=this.range,b=this.range.duplicate();if(a.nodeType==3){var d=this.createMark();latte.dom.appendNode.before(a,d.start.node);b.moveToElementText(d.start.node);b.collapse(!1);b.moveEnd("character",a.nodeValue.length);d.start.remove()}else b.moveToElementText(a);return c.inRange(b)},isNodeOverlap:function(a){var c=this.range.duplicate();if(a.nodeType==3){var b=this.createMark();latte.dom.appendNode.before(a,b.start.node);c.moveToElementText(b.start.node);c.collapse(!1);c.moveEnd("character",a.nodeValue.length);b.start.remove()}else c.moveToElementText(a);return this.isSelectorOverlap(c,!0)},isSelectorOverlap:function(a,c){var b=this.range;if(!c)a=a._hdl.range;if(a.compareEndPoints("StartToStart",b)>=0&&a.compareEndPoints("StartToEnd",b)<=0)return 1;if(a.compareEndPoints("EndToStart",b)>=0&&a.compareEndPoints("EndToEnd",b)<=0)return-1;return 0},select:function(){this.range.select()}});if((!document.createRange||!window.getSelection)&&document.selection)latte.selector.Handler=latte.selector.TridentHandler;
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Class({$name:"latte.selector.TridentTextHandler",$implements:[latte.selector.TextSelector],$const:function(a,b){if(!a)return!1;this.win=latte.dom.ele.getWindow(a);this.doc=this.win.document;this.eText=a;this.selector=new b(this)},win:null,doc:null,selector:null,eText:null,getSelector:function(){this.getPosition();return this.selector},getNewLineCnt:function(a){return(a.match(/\n/gi)||[]).length},getPosition:function(){var a=this.eText;try{a.focus();this.doc.body.createTextRange();this.doc.selection.createRange();var b=(void 0)(!0),c=(void 0)(!1);this.selector.offset={start:b,end:c};return{start:b,end:c}}catch(d){return this.selector.offset={start:0,end:0},{start:0,end:0}}},select:function(a,b){if(latte.isUND(a)&&latte.isUND(b))a=this.selector.offset.start,b=this.selector.offset.end;latte.isUND(b)&&(b=a);var c=this.eText.createTextRange(),d={start:this.selector.offset.start,end:this.selector.offset.end};try{return c.collapse(!0),c.moveStart("character",a),c.moveEnd("character",b-a),c.select(),this.selector.offset.start=a,this.selector.offset.end=b,!0}catch(e){return this.selector.offset.start=d.start,this.selector.offset.end=d.end,!1}},copy:function(){return this.eText.value.substring(this.selector.offset.start,this.selector.offset.end)},cut:function(){var a=this.copy();this.paste();return a},paste:function(a){var a=latte.isUND(a)||!latte.isSTR(a)?"":a,b=this.eText.value,c=this.selector.offset,d=b.substr(0,c.start);this.eText.value=d+a+b.substr(c.end);this.select(c.start,c.start+a.length-this.getNewLineCnt(d))}});if((!document.createRange||!window.getSelection)&&document.selection)latte.selector.TextHandler=latte.selector.TridentTextHandler;
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Class({$name:"latte.selector.W3CDOMHandler",$implements:[latte.selector.Selector],$const:function(a,b){if(!a)return!1;this.win=a;this.doc=this.win.document;this.selector=new b(this)},$addListner:function(){},win:null,doc:null,selector:null,range:null,getSelector:function(){if(!this.win||!this.win.getSelection)return!1;var a=this.win.getSelection();if(!a)return null;a.rangeCount&&a.rangeCount>1?(this.range=a.getRangeAt(0),a=a.getRangeAt(a.rangeCount-1),this.range.setEnd(a.endContainer,a.endOffset),this.select()):this.range=a.rangeCount?a.getRangeAt(0):this.doc.createRange();this.setStartProperty();this.setEndProperty();this.setProperty();return this.selector},setStartProperty:function(){this.selector.start={node:this.range.startContainer,offset:this.range.startOffset}},setEndProperty:function(){this.selector.end={node:this.range.endContainer,offset:this.range.endOffset}},setProperty:function(){var a=this.selector;a.collapsed=this.range.collapsed;a.blockNode=this.range.commonAncestorContainer},collapse:function(a){this.range.collapse(a);this.setStartProperty();this.setEndProperty();this.setProperty()},findNodeOffset:function(a){var b,c=a.parentNode;for(b=0;c.childNodes.length;b++)if(c.childNodes[b]==a)break;return b},cloneContents:function(){return this.range.cloneContents()},deleteContents:function(){this.range.deleteContents();this.setStartProperty();this.setEndProperty();this.setProperty()},extractContents:function(){var a=this.range.extractContents();this.setStartProperty();this.setEndProperty();this.setProperty();return a},insertNode:function(a){this.range.insertNode(a);this.setStartProperty();this.setEndProperty();this.setProperty()},surroundContents:function(a){var b=this.extractContents();a.appendChild(b);this.insertNode(a);this.selectNode(a)},setStart:function(a,b){this.range.setStart(a,b);this.setStartProperty();this.setProperty()},setStartBefore:function(a){this.range.setStartBefore(a);this.setStartProperty();this.setProperty()},setStartAfter:function(a){this.range.setStartAfter(a);this.setStartProperty();this.setProperty()},setEnd:function(a,b){this.range.setEnd(a,b);this.setEndProperty();this.setProperty()},setEndBefore:function(a){this.range.setEndBefore(a);this.setEndProperty();this.setProperty()},setEndAfter:function(a){this.range.setEndAfter(a);this.setEndProperty();this.setProperty()},selectNode:function(a){this.range.selectNode(a);this.setStartProperty();this.setEndProperty();this.setProperty()},selectNodeContents:function(a){this.range.selectNodeContents(a);this.setStartProperty();this.setEndProperty();this.setProperty()},compareBoundaryPoints:function(a,b){return this.range.compareBoundaryPoints(a,b)},cloneRange:function(){var a=this.selector,b=new this._class(this.win,a._class),c=b.selector;b.range=this.range.cloneRange();c.collapsed=a.collapsed;c.blockNode=a.blockNode;c.start.node=a.start.node;c.start.offset=a.start.offset;c.end.node=a.end.node;c.end.offset=a.end.offset;return c},getString:function(){return this.range.toString()},detach:function(){},isNodeInSelector:function(a){var b=this.range.cloneRange();b.selectNode(a);return b.compareBoundaryPoints(Range.START_TO_START,this.range)>=0&&b.compareBoundaryPoints(Range.END_TO_END,this.range)<=0},isNodeOverlap:function(a){var b=this.range.cloneRange();b.selectNode(a);return this.isSelectorOverlap(b,!0)},isSelectorOverlap:function(a,b){if(!b)a=a._hdl.range;if(a.compareBoundaryPoints(Range.START_TO_START,this.range)>=0&&a.compareBoundaryPoints(Range.END_TO_START,this.range)<=0)return 1;if(a.compareBoundaryPoints(Range.START_TO_END,this.range)>=0&&a.compareBoundaryPoints(Range.END_TO_END,this.range)<=0)return-1;return 0},select:function(){if(latte.isOPERA){var a=this.win.document.body,b=a.parentNode,c={start:{xpath:latte.xpath.getPath(this.selector.start.node),offset:this.selector.start.offset},end:{xpath:latte.xpath.getPath(this.selector.end.node),offset:this.selector.end.offset}};b.removeChild(a);b.appendChild(a);a.focus();this.setStart(latte.xpath.getNode(c.start.xpath,this.win.document),c.start.offset);this.setEnd(latte.xpath.getNode(c.end.xpath,this.win.document),c.end.offset)}a=this.win.getSelection();try{a.removeAllRanges()}catch(d){}a.addRange(this.range)}});if(document.createRange&&window.getSelection)latte.selector.Handler=latte.selector.W3CDOMHandler;
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.selector=="undefined")window.latte.selector={};latte.Class({$name:"latte.selector.W3CDOMTextHandler",$implements:[latte.selector.TextSelector],$const:function(a,b){if(!a)return!1;this.win=latte.dom.ele.getWindow(a);this.doc=this.win.document;this.eText=a;this.selector=new b(this)},win:null,doc:null,selector:null,eText:null,getSelector:function(){this.getPosition();return this.selector},getPosition:function(){try{var a=this.eText.selectionStart,b=this.eText.selectionEnd;this.selector.offset={start:a,end:b};return{start:a,end:b}}catch(c){return this.selector.offset={start:0,end:0},{start:0,end:0}}},select:function(a,b){if(latte.isUND(a)&&latte.isUND(b))a=this.selector.offset.start,b=this.selector.offset.end;latte.isUND(b)&&(b=a);var c={start:this.selector.offset.start,end:this.selector.offset.end};try{return this.selector.offset.start=a,this.selector.offset.end=b,this.eText.setSelectionRange(a,b),!0}catch(d){return this.selector.offset.start=c.start,this.selector.offset.end=c.end,!1}},copy:function(){return this.eText.value.substring(this.selector.offset.start,this.selector.offset.end)},cut:function(){var a=this.copy();this.paste();return a},paste:function(a){var a=latte.isUND(a)||!latte.isSTR(a)?"":a,b=this.eText.value,c=this.selector.offset;this.eText.value=b.substr(0,c.start)+a+b.substr(c.end);this.select(c.start,c.start+a.length-0)}});if(document.createRange&&window.getSelection)latte.selector.TextHandler=latte.selector.W3CDOMTextHandler;
if(typeof window.latte=="undefined")window.latte={};latte.Class({$name:"latte.selector.History",$const:function(a){this.init();this.limit=Math.max(a||0,3)},idx:-1,limit:3E4,oHist:null,init:function(){this.oHist=[];this.idx=-1},getItem:function(a){return this.oHist[this.idx+a]},getCurrentItem:function(){var a=this.oHist[this.idx]||this.createNewItem();return{undoPos:a.undoPos,redoPos:a.redoPos,content:a.content}},push:function(a,c){var b=this.oHist[this.idx];if(!b||b.content!=a.content){this.oHist[++this.idx]=a;this.cutNextHistory();if(b)b.undoPos=c;for(;this.limit<this.oHist.length;)this.oHist.shift(--this.idx)}},createNewItem:function(){return{undoPos:{},redoPos:{},content:null}},cutNextHistory:function(){for(;this.oHist.length-1>this.idx;)this.oHist.pop()}});
if(typeof window.latte=="undefined")window.latte={};latte.Class({$name:"latte.selector.HistoryManage",$const:function(a,d,b,c,f){var e=a==latte.dom.ele.getWindow(a)?a.document.body:a;this.oHistory=new b(d);this.oCommand=new c(a,f);this.oHotKey=latte.HotKey.getInstance();this.oNmHotKeys={undo:this.oHotKey.getHotkeyName(this.oHotKey.genKeyData(this.oCommand.hotkey.undo)),redo:this.oHotKey.getHotkeyName(this.oHotKey.genKeyData(this.oCommand.hotkey.redo))};this.oCommand.hotkey.undo&&this.oHotKey.regist(e,this.oCommand.hotkey.undo,this,"undo",{isStop:!0});this.oCommand.hotkey.redo&&this.oHotKey.regist(e,this.oCommand.hotkey.redo,this,"redo",{isStop:!0});this.save()},oHistory:null,oCommand:null,oHotKey:null,oLatestPos:null,oNmHotKeys:null,init:function(){this.oHistory.init();this.oLatestPos=null;this.save()},save:function(a,d){if(a){var b=this.oHotKey.getHotkeyName(a);if(b==this.oNmHotKeys.undo||b==this.oNmHotKeys.redo)return}var b=this.oHistory.getCurrentItem(),c=this.oCommand.getPosition(d);this.oCommand.save(b,c);this.oHistory.push(b,this.oLatestPos);this.oLatestPos=c},undo:function(){var a=this.oHistory.getItem(-1);this.oCommand.undo(a);a&&this.oHistory.idx--},redo:function(){var a=this.oHistory.getItem(1);this.oCommand.redo(a);a&&this.oHistory.idx++}});
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.range=="undefined")window.latte.range={};latte.Class({$name:"latte.range.Marker",$const:function(){},openMark:function(a){this._debug("open mark");var c=a.document.body,b=latte.getSelector(a);b.start.node.ownerDocument==null&&b.setStart(c,0);var c=b.cloneRange(),d=b.blockNode,e=latte.range.Marker.getInstance(),g={start:e.getStartPosition(b),end:e.getEndPosition(b)},f=b.collapsed,a={start:e.createMark(a.document,"s"),end:e.createMark(a.document,"e")};b.collapse(!1);b.insertNode(a.end.mark);if(f)latte.dom.appendNode.before(a.end.mark,a.start.mark);else try{c.collapse(!0),c.insertNode(a.start.mark)}catch(h){latte.dom.appendNode.before(a.end.mark,a.start.mark)}this.cleanEmptyNode(d);f||(this.reviseMarkPoint(a.start.mark),this.reviseMarkPoint(a.end.mark));b={_debug:this._debug,_className:this._className,selector:b,pos:g,markers:a,closeMark:this.closeMark,select:this.select,blockNode:d,collapsed:f,cleanEmptyNode:this.cleanEmptyNode,refreshSelection:this.refreshSelection};b.select();return b},reviseMarkPoint:function(a){a.nextSibling?a.previousSibling||this.moveMark(a,!1):this.moveMark(a,!0)},moveMark:function(a,c){for(var b=a,d=c?"nextSibling":"previousSibling";!b[d];){if(latte.selector.Selector.EXP_BODY.test(b.parentNode.nodeName))break;if(latte.selector.Selector.EXP_TABLE.test(b.parentNode.nodeName))break;b=b.parentNode}if(b&&b!=a)latte.dom.appendNode[c?"after":"before"](b,a)},cleanEmptyNode:function(a){latte.dom.ele.clearEmptyNode(a,!0)},refreshSelection:function(){var a=this.markers.start.refresh(),c=this.markers.end.refresh();this.selector.setStartAfter(a);this.selector.setEndBefore(c)},closeMark:function(){this._debug("close mark");this.cleanEmptyNode(this.blockNode);this.markers.start.refresh();this.markers.end.refresh();this.selector.setStartBefore(this.markers.start.mark);this.markers.start.remove();this.selector.setEndBefore(this.markers.end.mark);this.markers.end.remove();if(latte.isOPERA){var a=this.selector;latte.interval(1,function(){a.select();return!0})}else this.selector.select()},select:function(){this.markers.start.refresh();this.markers.end.refresh();this.selector.setStartAfter(this.markers.start.mark);this.selector.setEndBefore(this.markers.end.mark);this.selector.select()},getStartPosition:function(a){return{node:a.start.node,offset:a.start.offset}},getEndPosition:function(a){return{node:a.end.node,offset:a.end.offset}},createMark:function(a,c){var b=this.createUUID(c),d=latte.dom.ele.create("b",a);d.setAttribute("id",b);d.innerHTML="[M]";d.className="richedit_mark_temp";if(!latte.debug)d.style.textIndent="-500";return{uuid:b,doc:a,mark:d,refresh:this.refreshMark,remove:this.removeMark}},refreshMark:function(){return this.mark=this.doc.getElementById(this.uuid)},removeMark:function(){this.refresh();this.mark&&this.mark.parentNode.removeChild(this.mark)}});latte.Class.singletone(latte.range.Marker);
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.range=="undefined")window.latte.range={};latte.Class({$name:"latte.range.Spliter",$const:function(){},splitContents:function(b,c){var f=b.document.body,d=latte.getSelector(b),a=latte.dom.ele.create("div",b.document),e=latte.dom.ele.create("b",b.document),g=this.createUUID().replace(/\./g,"_"),h;h=this.getParagraphNodes(c);h.push(f);e.innerHTML="[M]";e.className="richedit_mark_temp";if(!latte.debug)e.style.textIndent="-500";e.className=g;latte.dom.appendNode.after(c,e.cloneNode(!0));f.appendChild(e.cloneNode(!0));d.selectNodeContents(f);d.setStartAfter(c);a.appendChild(d.extractContents());h[0]&&h[0].appendChild(c);a=latte.query("."+g,a)[0];d=this.getParagraphNodes(a);a.parentNode.removeChild(a);for(a=0;a<d.length;a++)latte.dom.move.contents(h[a],d[a]);g=latte.query("."+g,f)[0];f.removeChild(g)},getParagraphNodes:function(b){for(var c=[];b=b.parentNode;)latte.selector.Selector.EXP_PARAGRAPH.test(b.nodeName)&&c.push(b);return c}});latte.Class.singletone(latte.range.Spliter);
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.range=="undefined")window.latte.range={};latte.Class({$name:"latte.range.Cleaner",$const:function(){},exec:function(a,c,b){var b=this.createOption(b),d=c.markers,e=this.isBlockInNode(c.selector,d,b);this._debug("\uc81c\uac70\ub300\uc0c1 \ud3ec\ud568\uc5ec\ubd80 : "+e);if(b.onlyCheck)return e;var f=latte.range.Spliter.getInstance();f.splitContents(a,d.end.mark);f.splitContents(a,d.start.mark);if(!e)return e;this.clearBlock(a,c,b);return e},createOption:function(a){var c=[],b=[],d="";latte.iter(a.tagStyle,function(b){c.push(b.split(":"))});latte.iter(a.tagAttribute,function(a){a=a.split("|");b.push(a);d+=",["+a[0]+"]"});return{tagNames:a.tagNames||null,tagExp:a.tagNames?RegExp("^("+a.tagNames.replace(",","|")+")$","i"):null,tagStyle:c.length?c:null,tagAttribute:b.length?b:null,queryAttribute:d?d.substr(1):null}},isBlockInNode:function(a,c,b){for(var d=c.start.mark;(d=d.parentNode)&&!latte.selector.Selector.EXP_BODY.test(d.nodeName);){if(b.tagExp&&b.tagExp.test(d.nodeName))return 1;if(b.tagStyle&&this.isIncludeStyle(d,b.tagStyle))return 2;if(b.tagAttribute&&this.isIncludeAttribute(d,b.tagAttribute))return 3}for(d=c.end.mark;(d=d.parentNode)&&!latte.selector.Selector.EXP_BODY.test(d.nodeName);){if(b.tagExp&&b.tagExp.test(d.nodeName))return 4;if(b.tagStyle&&this.isIncludeStyle(d,b.tagStyle))return 5;if(b.tagAttribute&&this.isIncludeAttribute(d,b.tagAttribute))return 6}a.setStartAfter(c.start.mark);a.setEndBefore(c.end.mark);a=a.cloneContents();if(b.tagNames&&latte.query(b.tagNames,a).length>0)return 7;if(b.tagStyle&&this.isIncludeStyle(latte.query("[style]",a),b.tagStyle))return 8;if(b.tagAttribute&&this.isIncludeAttribute(latte.query(b.queryAttribute,a),b.tagAttribute))return 9;return!1},isIncludeStyle:function(a,c){var b;latte.iter(a.length?a:[a],function(a){latte.selector.Selector.EXP_TABLE.test(a.nodeName)||latte.iter(c,function(c){if(a&&a.style){if(c[1]&&a.style[c[0]]==c[1])return b=null;if(a.style[c[0]])return b=null}})});return b===null},removeStyle:function(a,c){latte.selector.Selector.EXP_TABLE.test(a.nodeName)||(latte.iter(c.tagStyle,function(b){a.style[b[0]]&&(a.style[b[0]]=b[2])}),a.getAttribute("style")||a.removeAttribute("style"),/^(span|font)$/i.test(a.nodeName)&&!a.attributes.length&&latte.dom.move.strip(a))},isIncludeAttribute:function(a,c){var b,d;latte.iter(a.length?a:[a],function(a){latte.selector.Selector.EXP_TABLE.test(a.nodeName)||latte.iter(c,function(c){if(a&&a.getAttribute&&(d=a.getAttribute(c[0]))!==null){if(c[1]&&d==c[1])return b=null;if(d.length)return b=null}})});return b===null},removeAttribute:function(a,c){latte.selector.Selector.EXP_TABLE.test(a.nodeName)||(latte.iter(c.tagAttribute,function(b){a.getAttribute&&a.getAttribute(b[0])!==null&&(b[2].length?a.setAttribute(b[0],b[2]):a.removeAttribute(b[0]))}),/^(span|font)$/i.test(a.nodeName)&&!a.attributes.length&&latte.dom.move.strip(a))},clearBlock:function(a,c,b){var d=c.selector,e=c.markers,f=this,a=a.document.body,g=b.tagNames?latte.query(b.tagNames,a):[],g=latte.array.merge(g,b.tagStyle?latte.query("[style]",a):[]),g=latte.array.merge(g,b.tagAttribute?latte.query(b.queryAttribute,a):[]);latte.iter(g,function(a){c.refreshSelection();if(!(e.start.mark===a||e.end.mark===a))if(!a.parentNode||a.parentNode.nodeType!=11&&d.isNodeInSelector(a))b.tagExp&&b.tagExp.test(a.nodeName)?latte.dom.popNode.before(a):(b.tagStyle&&f.isIncludeStyle(a,b.tagStyle)&&f.removeStyle(a,b),b.tagAttribute&&f.isIncludeAttribute(a,b.tagAttribute)&&f.removeAttribute(a,b))});this._debug("\uc0ad\uc81c\ub300\uc0c1 \ub178\ub4dc \uc81c\uac70");latte.dom.ele.clearEmptyNode(d.blockNode,!0)}});latte.Class.singletone(latte.range.Cleaner);
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.range=="undefined")window.latte.range={};latte.Class({$name:"latte.range.Creator",$const:function(){},exec:function(a,f,e){function d(){a.document.execCommand("createlink",!1,b);return b}this._debug("\uc0bd\uc785 \uc2dc\uc791");var b=this.createUUID().replace(/\./g,"_"),c=this.getTargetNodes(f,e),c=this.deactivateAnchor(f,c,d);this.insertAnchor(f,c,d);this.activateAnchor(c);c=latte.query("a[href="+b+"], a[id="+b+"]",a.document.body);return this.replaceAnchor(c,e)},getTargetNodes:function(a,f){var e=a.selector,d=a.markers,b=/^a$/i.test(f.node.nodeName),c=[];a.refreshSelection();latte.iter(latte.query("a",a.blockNode.ownerDocument),function(a){d.start.mark==a||d.end.mark==a||!e.isNodeInSelector(a)||(b?latte.dom.move.strip(a):c.push(a))});return c},deactivateAnchor:function(a,f,e){if(!f.length)return[];var d=[],b,c,j,g=a.selector,h=latte.dom.ele.create("b",a.blockNode.ownerDocument),i=latte.dom.ele.create("b",a.blockNode.ownerDocument);h.innerHTML="{a}";i.innerHTML="{/a}";h.className="latte_mark_temp";i.className="latte_mark_temp";if(!latte.debug)h.style.textIndent="-500",i.style.textIndent="-500";latte.iter(f,function(a){b=latte.dom.appendNode.before(a,h.cloneNode(!0));c=latte.dom.appendNode.after(a,i.cloneNode(!0));latte.dom.move.strip(a);g.setStartAfter(b);g.setEndBefore(c);g.select();j=e();g.setStartAfter(b);g.setEndBefore(c);a.appendChild(g.extractContents());a.firstChild.setAttribute("id",j);d.push([b,a]);c.parentNode.removeChild(c)});return d},insertAnchor:function(a,f,e){function d(a,b){if(a.collapsed)return!1;a.select();b()}a.select();var b=a.selector,a=a.markers;latte.iter(f,function(a){b.setEndBefore(a[0]);d(b,e);b.setStartAfter(a[0])});b.setEndBefore(a.end.refresh());d(b,e)},activateAnchor:function(a){latte.iter(a,function(a){latte.dom.appendNode.before(a[0],a[1]);a[0].parentNode.removeChild(a[0])})},replaceAnchor:function(a,f){var e,d=[];latte.iter(a,function(a){e=latte.dom.appendNode.before(a,f.node.cloneNode(!0));latte.dom.move.contents(e,a);d.push(e)});return d}});latte.Class.singletone(latte.range.Creator);
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.range=="undefined")window.latte.range={};latte.Class({$name:"latte.range.Paragraph",$const:function(){},exec:function(b,c){var a=b.selector,e=b.markers,d=e.start.mark.ownerDocument;this.moveMark(e.start.refresh(),!0);this.moveMark(e.end.refresh(),!1);b.select();latte.isMSIE&&!latte.isMSIE9?(latte.iter(latte.query(latte.selector.Selector.TAG_PARAGRAPH,d.body),function(a){latte.css.addClass(a,"latte_mark_paragraph")}),apNodes=this.getAroundParagraph(latte.query(".latte_mark_paragraph",d.body),a)):apNodes=this.getAroundParagraph(latte.query(latte.selector.Selector.TAG_PARAGRAPH,d.body),a);a=this.surroundParagraph(b,apNodes,c.node);this.removeMark(e.start.refresh(),d);this.removeMark(e.end.refresh(),d);return a},moveMark:function(b,c){var a=b.previousSibling,e=b.nextSibling,d=latte.selector.Selector.EXP_TABLE,i=latte.selector.Selector.EXP_PARAGRAPH,j=b.cloneNode(!0);b._cloneUUID=j.getAttribute("id")+"c";j.setAttribute("id",b._cloneUUID);latte.dom.appendNode[c?"before":"after"](b,j);if(latte.isMSIE&&!c&&a&&/^[\r\n]+$/.test(a.nodeValue)&&a.previousSibling&&i.test(a.previousSibling.nodeName))latte.dom.appendNode.before(a,b),latte.dom.appendNode.after(b,j);else if(!a||!i.test(a.nodeName))if(!e||!i.test(e.nodeName)){a=b;for(e=c?"previousSibling":"nextSibling";a[e];)if(a=a[e],i.test(a.nodeName)){latte.dom.appendNode[c?"after":"before"](a,b);return}for(a=b;a.parentNode;){a=a.parentNode;if(i.test(a.nodeName))break;if(a.nodeName=="BODY")break}if(a.nodeName=="BODY"||d.test(a.nodeName))c?(a=a.firstChild,a!==b&&latte.dom.appendNode.before(a,b)):a.appendChild(b);else latte.dom.appendNode[c?"before":"after"](a,b)}},removeMark:function(b,c){var a;if(a=c.getElementById(b._cloneUUID))latte.dom.appendNode.before(a,b),a.parentNode.removeChild(a)},getAroundParagraph:function(b,c){var a=[];latte.iter(b,function(b){latte.isMSIE&&!latte.isMSIE9&&latte.css.removeClass(b,"latte_mark_paragraph");c.isNodeOverlap(b)&&a.push(b)});return a},surroundParagraph:function(b,c,a){var e=b.selector,d=b.markers,i=this,j,h=d.start.refresh(),k=[],l=h;c.push(d.end.refresh());latte.iter(c,function(c){b.select();if(h!==l){k.push(h);for(var f=h,g=f,d=g.nodeName;d!="BODY"&&g.parentNode;)g=g.parentNode,d=g.nodeName,d!="BODY"&&(latte.selector.Selector.EXP_TABLE.test(d)||latte.selector.Selector.EXP_OLUL.test(d)||latte.selector.Selector.EXP_PARAGRAPH.test(d)&&(f=g));h=latte.selector.Selector.EXP_PARAGRAPH.test(f.nodeName)?f:null}f=h;!f||!c?f=null:(g=latte.getSelector(latte.dom.ele.getWindow(f)),g.selectNode(f),g.isNodeInSelector(c)?f=!1:(g.setStartAfter(f),g.setEndBefore(c),f=g.collapsed?!1:e.isSelectorOverlap(g)));f&&(e.setStartAfter(h),e.setEndBefore(c),(j=i.surroundSection(e,a))&&k.push(j));h=c;return[]});return k},surroundSection:function(b,c){if(/^[\s]*$/.test(b.getString()))return null;var a=c.cloneNode(!0);b.surroundContents(a);return a}});latte.Class.singletone(latte.range.Paragraph);
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.range=="undefined")window.latte.range={};latte.Class({$name:"latte.range.LineBreaker",$const:function(){},exec:function(b,a,c){var d=a.selector,e=a.markers;d.setStartBefore(e.start.refresh());d.setEndAfter(e.end.refresh());a.blockNode=d.blockNode;return this[latte.query(latte.selector.Selector.TAG_PARAGRAPH,d.cloneContents()).length?"multiLineBreak":"singleLineBreak"](b,a,c)},singleLineBreak:function(b,a,c){var d=a.selector,e=a.markers;a.select();a.selector.deleteContents();for(var f=e.start.refresh();f.parentNode&&(f=f.parentNode);)if(latte.selector.Selector.EXP_PARAGRAPH.test(f.nodeName))break;d.setStartBefore(f);d.setEndAfter(e.start.refresh());d.insertNode(d.extractContents());return this.closeBreak(a,c,b)},multiLineBreak:function(b,a,c){var d=a.selector,e=a.markers;this.surroundParagraph(d,e.start.refresh(),c.node,!0);this.surroundParagraph(d,e.end.refresh(),c.node,!1);var f=e.start.refresh();if(latte.selector.Selector.EXP_OLUL.test(f.nodeName))return this.insertNewLine(b,a);d.setStartBefore(f);d.setEndAfter(e.start.refresh());d.insertNode(d.extractContents());return this.closeBreak(a,c,b)},insertNewLine:function(b,a){var c=a.selector,d=a.markers,e=latte.dom.ele.create("br",b.document);c.setStartAfter(d.start.refresh());c.collapse(!0);c.insertNode(e);a.closeMark();c.setStartAfter(e);c.collapse(!0);c.select();return e},surroundParagraph:function(b,a,c,d){d=a[d?"nextSibling":"previousSibling"];if(!d||!latte.selector.Selector.EXP_PARAGRAPH.test(d.nodeName))return null;c=c.cloneNode(!0);b.selectNode(a);b.surroundContents(c);return c},closeBreak:function(b){var a=b.markers,c=b.selector;b.select();b.selector.deleteContents();for(b=a.start.refresh();b.parentNode&&(b=b.parentNode);)if(latte.selector.Selector.EXP_PARAGRAPH.test(b.nodeName))break;c.selectNodeContents(b);c.setStartAfter(a.start.mark);c.select();for(var b=c.cloneContents(),d=a.start.refresh(),e=a.end.refresh();d.parentNode&&(d=d.parentNode);)if(latte.selector.Selector.EXP_PARAGRAPH.test(d.nodeName))break;for(;e.parentNode&&(e=e.parentNode);)if(latte.selector.Selector.EXP_PARAGRAPH.test(e.nodeName))break;a.start.remove();a.end.remove();e.childNodes.length?latte.dom.appendNode.before(e.firstChild,b):e.appendChild(b);d=this.hookEmptyParagraph(d);for(fNode=e=this.hookEmptyParagraph(e);fNode.firstChild&&(fNode=fNode.firstChild););latte.dom.ele.isSingleNode(fNode)?c.selectNode(fNode):c.setStart(fNode,0);c.collapse(!0);try{var f=latte.dom.ele.create(latte.isMSIE?"a":"button",e.ownerDocument);f.innerHTML="_";c.insertNode(f);f.focus();c.selectNode(f);c.deleteContents();c.select()}catch(g){}return[d,e]},hookEmptyParagraph:function(b){if(b.childNodes.length)for(var a=b.childNodes.length-1;a>=0;a--)latte.dom.ele.clearEmptyNode(b.childNodes[a],!0);if(!/^[\s]*$/.test(b.innerHTML))return b;a=latte.dom.ele.create("div",b.ownerDocument);a.appendChild(b.cloneNode(!1));a=a.firstChild;a.innerHTML="&nbsp;";latte.dom.appendNode.before(b,a);b.parentNode.removeChild(b);return a}});latte.Class.singletone(latte.range.LineBreaker);
if(typeof window.latte=="undefined")window.latte={};if(typeof window.latte.range=="undefined")window.latte.range={};latte.Class({$name:"latte.range.LineList",$const:function(){},$OL:"OL",$UL:"UL",exec:function(a,c){var b=latte.getSelector(a);if(b=this.getLineNode(b.blockNode))if(c.listType){if(b.nodeName!=c.orderType)return this.toggleLineList(a,{orderType:b.nodeName}),this.exec(a,c);return b.style.listStyleType=c.listType}else return this.toggleLineList(a,{orderType:b.nodeName});if(c.listType)return this.toggleLineList(a,c),b=latte.getSelector(a),b=this.getLineNode(b.blockNode),b.style.listStyleType=c.listType},getLineNode:function(a){for(;!/^(ul|ol|body)$/i.test(a.nodeName)&&a.parentNode&&(a=a.parentNode););return/^body$/i.test(a.nodeName)?null:a},toggleLineList:function(a,c){a.document.execCommand(latte.range.LineList.OL==c.orderType?"insertorderedlist":"insertunorderedlist",!1,!1)}});latte.Class.singletone(latte.range.LineList);
if(typeof window.latte=="undefined")window.latte={};latte.command={marker:latte.range.Marker.getInstance(),cleaner:latte.range.Cleaner.getInstance(),creator:latte.range.Creator.getInstance(),paragraph:latte.range.Paragraph.getInstance(),lineBreaker:latte.range.LineBreaker.getInstance(),lineList:latte.range.LineList.getInstance(),"delete":function(a){a=this.marker.openMark(a);a.selector.deleteContents();a.closeMark();return!0},removeformat:function(a){var c=this.marker.openMark(a),b=c.selector,d=c.markers,e=latte.range.Spliter.getInstance();e.splitContents(a,d.end.mark);e.splitContents(a,d.start.mark);latte.iter(latte.query("*",b.blockNode),function(a){c.refreshSelection();b.isNodeInSelector(a)&&(latte.dom.ele.isSingleNode(a)||latte.selector.Selector.EXP_PARAGRAPH.test(a.nodeName)||d.start.mark===a||d.end.mark===a||latte.dom.move.strip(a))});c.closeMark();return!0},insertText:function(a,c){var b=this.marker.openMark(a),d=b.selector,e=c.nodeType==3?c:latte.dom.ele.createText(c,a.doc);d.deleteContents();latte.dom.appendNode.before(b.markers.end.mark,e);b.closeMark();return e},insertHTML:function(a,c){var b=this.marker.openMark(a),d=a.document.createDocumentFragment(),e=latte.dom.ele.create("div",a.document);for(e.innerHTML=c;e.firstChild;)d.appendChild(e.firstChild);b.selector.deleteContents();b.selector.insertNode(d);b.closeMark();return d},insertTab:function(a,c){for(var c=c||4,b=latte.getSelector(a),b=latte.dom.ele.create("div",a.doc);c-- >0;)b.innerHTML+="&nbsp;";this.insertText(b.firstChild);b=latte.getSelector(a);b.collapse(!1);b.select();return!0},copy:function(a){a=this.marker.openMark(a);this.clipboard=a.selector.cloneContents();a.closeMark();return this.clipboard},remove:function(a,c){var b=this.marker.openMark(a),d=this.cleaner.exec(a,b,c);b.closeMark();return d},removeOrInsert:function(a,c,b){var d=this.marker.openMark(a);if(this.cleaner.exec(a,d,c))return d.closeMark(),!0;a=this.creator.exec(a,d,b);d.closeMark();return a||[]},removeAndInsert:function(a,c,b){var d=this.marker.openMark(a);this.cleaner.exec(a,d,c);a=this.creator.exec(a,d,b);d.closeMark();return a||[]},insert:function(a,c){var b=this.marker.openMark(a);this.cleaner.exec(a,b,{onlyCheck:!0});var d=this.creator.exec(a,b,c);b.closeMark();return d||[]},isInclude:function(a,c){var b,d=this.marker.openMark(a);c.onlyCheck=!0;b=this.cleaner.exec(a,d,c);d.closeMark();return b},surroundParagraph:function(a,c){var b=this.marker.openMark(a),d=this.paragraph.exec(b,c);c.iterFnc&&latte.iter(d,c.iterFnc);b.closeMark();return d},lineBreak:function(a,c){var b=this.marker.openMark(a);this.paragraph.exec(b,c);return this.lineBreaker.exec(a,b,c)},newLine:function(a,c){var b=latte.getSelector(a),d=a.document,e=latte.dom.ele.create("button",d);b.collapsed||b.deleteContents();b.insertNode(e);latte.dom.appendNode.before(e,c.node);e.focus();latte.isFIREFOX&&d.body.focus();b.selectNode(e);b.deleteContents();b.collapse(!0);b.select();return c.node},deployNodes:function(a,c,b){latte.iter(a,function(a){latte.iter(latte.query(c,a),b)})}};
if(typeof window.latte=="undefined")window.latte={};latte.Class({$name:"latte.security.XSS",PTN_CHR10:RegExp("\r","g"),PTN_CHR13:RegExp("\n","g"),PTN_CHR10NL2:RegExp("##%1","g"),PTN_CHR13NL2:RegExp("##%2","g"),$const:function(a,d,e,c){this.setLevel(a);this.setXSSTag(d);this.setXSSURL(e);this.setXSSAttribute(c)},$LEVEL_MAX:2,$LEVEL_MIN:1,$LEVEL_NON:0,xssLevel:2,xssTagLst:null,xssURLLst:null,xssAttLst:null,xssTagExp:null,setLevel:function(a){this.xssLevel=a},setXSSTag:function(a){this.setXSSTagExp(this.xssTagLst=a)},setXSSURL:function(a){this.xssURLLst=a},setXSSAttribute:function(a){this.xssAttLst=a},setXSSTagExp:function(a){this.xssTagExp=RegExp("<(\\?import[^>]*|!--[[^]]+]>|<![[^]]+]--|s*[/]?s*("+a.join("|")+")[^>]*)>","gi")},replaceXSSAttribute:function(a,d,e){try{a[d]=e,e!=a.getAttribute(d)&&a.setAttribute(d,e)}catch(c){try{a.setAttribute(d,encodeURIComponent(e))}catch(h){try{a.removeAttribute(d)}catch(f){a.parentNode.removeChild(a)}}}},replaceXSSStyle:function(a){function d(a,d,f,g){return d+e.replaceXSSURL(f)+g}var e=this,a=a.replace(/\\[0-9]*/g,"");this.xssLevel==latte.security.XSS.LEVEL_MAX&&(a=a.replace(/@(import)/gi,"/*xss $1*/"),a=a.replace(/-(moz-binding)/gi,"/*xss $1*/"));a=a.replace(/:\s*(expression|noxss)/gi,":xss-$1");a=a.replace(/(@[^@]4+['"]*)([^'"]*)(['"]*)/gi,function(a){return a.replace(/(@import\s*['"]*)([^'"]*)(['"]*)/gi,d)});return a=a.replace(/([:\s]*url\(['"]*)([^\)]*)(\))/gi,d)},replaceXSSURL:function(a){if(/^(http|https|ftp|mailto)/i.test(a))return a;if(/^[a-z]+:\/[\/]/i.test(a))return a.replace(/^[a-z]+:\/[\/]/i,"http://");return"http://"+a},protect:function(a,d){if(this.xssLevel==latte.security.XSS.LEVEL_NON)return a;var a=a.replace(latte.security.XSS.PTN_CHR10,"##%1"),a=a.replace(latte.security.XSS.PTN_CHR13,"##%2"),e=this,c=latte.dom.ele.create("div",d);if(this.xssLevel>=latte.security.XSS.LEVEL_MIN){this.xssTagLst&&this.xssTagLst.length&&(a=a.replace(this.xssTagExp,"&lt;[$1]&gt;"));c.innerHTML=a.replace(/<(\?import[^>]*|\s*[\/]?\s*xss[^>]*)>/gi,"&lt;[$1]&gt;");latte.iter(latte.query("style",c),function(a){a.type="text/css";var b=e.replaceXSSStyle(a.innerHTML);try{a.innerHTML=b}catch(c){a.styleSheet.cssText=b}});var h=latte.query("param[name=url]",c);!h.length&&latte.isMSIE&&latte.iter(latte.query("object",c),function(a){for(var b,c=0;c<a.childNodes.length;c++)b=a.childNodes[c],/param/i.test(b.nodeName)&&/url/i.test(b.name)&&h.push(b)});latte.iter(h,function(a){var b=e.replaceXSSURL(a.getAttribute("value"));e.replaceXSSAttribute(a,"value",b)});this.xssURLLst&&this.xssURLLst.length&&latte.iter(this.xssURLLst,function(a){latte.iter(latte.query("["+a+"]",c),function(b){var c=e.replaceXSSURL(b.getAttribute(a));e.replaceXSSAttribute(b,a,c)})});this.xssAttLst&&this.xssAttLst.length&&latte.iter(this.xssAttLst,function(a){latte.iter(latte.query("["+a+"]",c),function(b){b.removeAttribute(a);latte.isMSIE&&latte.dom.hookHTML(b,d)})});latte.iter(latte.query("[style]",c),function(a){var b=a.getAttribute("style")||a.style.cssText||"";if(latte.isOBJ(b))b=a.style.cssText;b&&(b=b.replace(/\/\*(.*?)\*[\/]/g,""),a.setAttribute("style",e.replaceXSSStyle(b)),!b&&latte.isMSIE&&latte.dom.hookHTML(a,d))});latte.iter(latte.query("object",c),function(a){var b=a.getAttribute("type");b&&b.toLowerCase()=="text/x-scriptlet"&&(a.removeAttribute("type"),e.replaceXSSAttribute(a,"type","xss-text/xss-x-scriptlet"))});this.xssLevel==latte.security.XSS.LEVEL_MAX&&latte.iter(latte.query("embed",c),function(a){var b=a.getAttribute("allowscriptaccess");b&&b.toLowerCase()=="always"&&(a.removeAttribute("allowscriptaccess"),e.replaceXSSAttribute(a,"allowscriptaccess","xss-always"))})}if(this.xssLevel>=latte.security.XSS.LEVEL_MAX){var f,g,i=latte.query("*",c);latte.iter(i,function(a){g=a.attributes||[];for(var b=0;b<g.length;b++)f=g[b],/^on/i.test(f.name)&&f.value!=null&&a.removeAttribute(f.name)})}return c.innerHTML.replace(latte.security.XSS.PTN_CHR13NL2,"\n").replace(latte.security.XSS.PTN_CHR10NL2,"\r")},evade:function(a,d){var e=this,a=a||document.body;latte.iter(latte.query(d||"input[type=text], input[type=hidden], textarea",a),function(c){if(!(c.value==null||c.value==""))try{c.value=e.protect(c.value,a.ownerDocument)}catch(d){}})}});latte.security.xss=new latte.security.XSS(latte.security.XSS.LEVEL_MAX,["html","head","script","base","link","title","meta","body","iframe","frame","frameset"],["src","href","dynsrc","lowsrc","background"],["datasrc","datafld","dataformatas"]);
if(typeof window.latte=="undefined")window.latte={};latte.Class({$name:"latte.BehindForm",$const:function(){},createForm:function(c,a){var a=a||window,b=latte.dom.ele.create("form",a.document);latte.iter(c,function(a,c){b.setAttribute(c,a)});b._submit=function(){try{a.document.body.appendChild(b),b.submit()}catch(c){}try{a.document.body.removeChild(b)}catch(d){}};return b},appendElements:function(c,a){var b;latte.iter(a,function(a){b=latte.dom.ele.create("input",c.ownerDocument);latte.iter(a,function(a,c){b.setAttribute(c,a)});c.appendChild(b)})}});latte.Class.singletone(latte.BehindForm);